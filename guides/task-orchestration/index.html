<!DOCTYPE html><html class=no-js lang=en> <head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="Task Orchestration and Execution Framework Documentation" name=description><link href=https://aipartnerup.github.io/apflow/guides/task-orchestration/ rel=canonical><link href=../../getting-started/tutorials/tutorial-03-dependencies/ rel=prev><link href=../executor-selection/ rel=next><link href=../../assets/favicon.ico rel=icon><meta content="mkdocs-1.6.1, mkdocs-material-9.7.1" name=generator><title>Task Orchestration - apflow Documentation</title><link href=../../assets/stylesheets/main.484c7ddc.min.css rel=stylesheet><link href=../../assets/stylesheets/palette.ab4e12ef.min.css rel=stylesheet><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback" rel=stylesheet><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body data-md-color-accent=indigo data-md-color-primary=indigo data-md-color-scheme=default dir=ltr> <input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox> <input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a class=md-skip href=#task-orchestration-guide> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav aria-label=Header class="md-header__inner md-grid"> <a aria-label="apflow Documentation" class="md-header__button md-logo" data-md-component=logo href=../.. title="apflow Documentation"> <img alt=logo src=../../assets/logo.svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> apflow Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Task Orchestration </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input aria-label="Switch to dark mode" class=md-option data-md-color-accent=indigo data-md-color-media data-md-color-primary=indigo data-md-color-scheme=default id=__palette_0 name=__palette type=radio> <label class="md-header__button md-icon" for=__palette_1 hidden title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> <input aria-label="Switch to light mode" class=md-option data-md-color-accent=indigo data-md-color-media data-md-color-primary=indigo data-md-color-scheme=slate id=__palette_1 name=__palette type=radio> <label class="md-header__button md-icon" for=__palette_0 hidden title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input aria-label=Search autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=Search required spellcheck=false type=text> <label class="md-search__icon md-icon" for=__search> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav aria-label=Search class=md-search__options> <button aria-label=Clear class="md-search__icon md-icon" tabindex=-1 title=Clear type=reset> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix tabindex=0> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a class=md-source data-md-component=source href=https://github.com/aipartnerup/apflow title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 512 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </div> <div class=md-source__repository> aipartnerup/apflow </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav aria-label=Tabs class=md-tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a class=md-tabs__link href=../..> Home </a> </li> <li class=md-tabs__item> <a href=../../getting-started/ class=md-tabs__link> Getting Started </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=./ class=md-tabs__link> Guides </a> </li> <li class=md-tabs__item> <a href=../../cli/ class=md-tabs__link> CLI </a> </li> <li class=md-tabs__item> <a href=../../api/python/ class=md-tabs__link> API Reference </a> </li> <li class=md-tabs__item> <a href=../../examples/basic_task/ class=md-tabs__link> Examples </a> </li> <li class=md-tabs__item> <a href=../../architecture/overview/ class=md-tabs__link> Architecture </a> </li> <li class=md-tabs__item> <a href=../../protocol/ class=md-tabs__link> Protocol </a> </li> <li class=md-tabs__item> <a href=../../development/setup/ class=md-tabs__link> Development </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav aria-label=Navigation class="md-nav md-nav--primary md-nav--lifted" data-md-level=0> <label class=md-nav__title for=__drawer> <a aria-label="apflow Documentation" class="md-nav__button md-logo" data-md-component=logo href=../.. title="apflow Documentation"> <img alt=logo src=../../assets/logo.svg> </a> apflow Documentation </label> <div class=md-nav__source> <a class=md-source data-md-component=source href=https://github.com/aipartnerup/apflow title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 512 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </div> <div class=md-source__repository> aipartnerup/apflow </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../..> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_2 type=checkbox> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Getting Started </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_2_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../getting-started/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/hello-world/ class=md-nav__link> <span class=md-ellipsis> Hello World </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/quick-start/ class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/concepts/ class=md-nav__link> <span class=md-ellipsis> Core Concepts </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/examples/ class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_2_7 type=checkbox> <label class=md-nav__link for=__nav_2_7 id=__nav_2_7_label tabindex=0> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_2_7_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_2_7> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../getting-started/tutorials/tutorial-01-first-steps/ class=md-nav__link> <span class=md-ellipsis> First Steps </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/tutorials/tutorial-02-task-trees/ class=md-nav__link> <span class=md-ellipsis> Task Trees </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/tutorials/tutorial-03-dependencies/ class=md-nav__link> <span class=md-ellipsis> Dependencies </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input checked class="md-nav__toggle md-toggle" id=__nav_3 type=checkbox> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Guides </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=true aria-labelledby=__nav_3_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Guides </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id=__toc type=checkbox> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Task Orchestration </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Task Orchestration </span> </a> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=#what-youll-learn> <span class=md-ellipsis> What You'll Learn </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#table-of-contents> <span class=md-ellipsis> Table of Contents </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#core-concepts> <span class=md-ellipsis> Core Concepts </span> </a> <nav aria-label="Core Concepts" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#what-is-task-orchestration> <span class=md-ellipsis> What is Task Orchestration? </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#key-components> <span class=md-ellipsis> Key Components </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#task-tree-structure> <span class=md-ellipsis> Task Tree Structure </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#critical-distinction-parent-child-vs-dependencies> <span class=md-ellipsis> Critical Distinction: Parent-Child vs Dependencies </span> </a> <nav aria-label="Critical Distinction: Parent-Child vs Dependencies" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#parent-child-relationship-parent_id> <span class=md-ellipsis> Parent-Child Relationship (parent_id) </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#dependencies-dependencies> <span class=md-ellipsis> Dependencies (dependencies) </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#combined-example> <span class=md-ellipsis> Combined Example </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#task-lifecycle> <span class=md-ellipsis> Task Lifecycle </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#creating-task-trees> <span class=md-ellipsis> Creating Task Trees </span> </a> <nav aria-label="Creating Task Trees" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#basic-task-tree> <span class=md-ellipsis> Basic Task Tree </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#hierarchical-task-tree> <span class=md-ellipsis> Hierarchical Task Tree </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#dependencies> <span class=md-ellipsis> Dependencies </span> </a> <nav aria-label=Dependencies class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#dependency-resolution-flow> <span class=md-ellipsis> Dependency Resolution Flow </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#basic-dependency> <span class=md-ellipsis> Basic Dependency </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#sequential-pipeline> <span class=md-ellipsis> Sequential Pipeline </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#multiple-dependencies> <span class=md-ellipsis> Multiple Dependencies </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#dependency-types> <span class=md-ellipsis> Dependency Types </span> </a> <nav aria-label="Dependency Types" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#required-dependencies> <span class=md-ellipsis> Required Dependencies </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#optional-dependencies> <span class=md-ellipsis> Optional Dependencies </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#priorities> <span class=md-ellipsis> Priorities </span> </a> <nav aria-label=Priorities class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#priority-levels> <span class=md-ellipsis> Priority Levels </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#basic-priority> <span class=md-ellipsis> Basic Priority </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#priority-with-dependencies> <span class=md-ellipsis> Priority with Dependencies </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#priority-best-practices> <span class=md-ellipsis> Priority Best Practices </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#common-patterns> <span class=md-ellipsis> Common Patterns </span> </a> <nav aria-label="Common Patterns" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pattern-1-sequential-pipeline> <span class=md-ellipsis> Pattern 1: Sequential Pipeline </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pattern-2-fan-out-parallel> <span class=md-ellipsis> Pattern 2: Fan-Out (Parallel) </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pattern-3-fan-in-converge> <span class=md-ellipsis> Pattern 3: Fan-In (Converge) </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pattern-4-complex-workflow> <span class=md-ellipsis> Pattern 4: Complex Workflow </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pattern-5-conditional-execution> <span class=md-ellipsis> Pattern 5: Conditional Execution </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#best-practices> <span class=md-ellipsis> Best Practices </span> </a> <nav aria-label="Best Practices" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#1-use-meaningful-task-names> <span class=md-ellipsis> 1. Use Meaningful Task Names </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#2-set-appropriate-priorities> <span class=md-ellipsis> 2. Set Appropriate Priorities </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#3-handle-dependencies-explicitly> <span class=md-ellipsis> 3. Handle Dependencies Explicitly </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#4-use-parent-child-for-organization-dependencies-for-execution> <span class=md-ellipsis> 4. Use Parent-Child for Organization, Dependencies for Execution </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#5-handle-errors-gracefully> <span class=md-ellipsis> 5. Handle Errors Gracefully </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#6-keep-task-trees-manageable> <span class=md-ellipsis> 6. Keep Task Trees Manageable </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#task-cancellation> <span class=md-ellipsis> Task Cancellation </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#task-re-execution> <span class=md-ellipsis> Task Re-execution </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#streaming-execution> <span class=md-ellipsis> Streaming Execution </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#dependency-resolution> <span class=md-ellipsis> Dependency Resolution </span> </a> <nav aria-label="Dependency Resolution" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#copy-link-and-snapshot-behavior> <span class=md-ellipsis> Copy, Link, and Snapshot Behavior </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#next-steps> <span class=md-ellipsis> Next Steps </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#task-data-fields-inputs-params-and-result> <span class=md-ellipsis> Task Data Fields: inputs, params, and result </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../executor-selection/ class=md-nav__link> <span class=md-ellipsis> Executor Selection </span> </a> </li> <li class=md-nav__item> <a href=../custom-tasks/ class=md-nav__link> <span class=md-ellipsis> Custom Tasks </span> </a> </li> <li class=md-nav__item> <a href=../best-practices/ class=md-nav__link> <span class=md-ellipsis> Best Practices </span> </a> </li> <li class=md-nav__item> <a href=../cli/ class=md-nav__link> <span class=md-ellipsis> CLI </span> </a> </li> <li class=md-nav__item> <a href=../api-server/ class=md-nav__link> <span class=md-ellipsis> API Server </span> </a> </li> <li class=md-nav__item> <a href=../distributed-cluster/ class=md-nav__link> <span class=md-ellipsis> Distributed Cluster </span> </a> </li> <li class=md-nav__item> <a href=../library-usage/ class=md-nav__link> <span class=md-ellipsis> Library Usage </span> </a> </li> <li class=md-nav__item> <a href=../scheduler/ class=md-nav__link> <span class=md-ellipsis> Scheduler </span> </a> </li> <li class=md-nav__item> <a href=../extensions/ class=md-nav__link> <span class=md-ellipsis> Extensions </span> </a> </li> <li class=md-nav__item> <a href=../environment-variables/ class=md-nav__link> <span class=md-ellipsis> Environment Variables </span> </a> </li> <li class=md-nav__item> <a href=../faq/ class=md-nav__link> <span class=md-ellipsis> FAQ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_4 type=checkbox> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> CLI </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_4_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> CLI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cli/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../cli/commands/ class=md-nav__link> <span class=md-ellipsis> Commands </span> </a> </li> <li class=md-nav__item> <a href=../../cli/configuration/ class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../cli/examples/ class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=../../cli/api-gateway/ class=md-nav__link> <span class=md-ellipsis> API Gateway </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_5 type=checkbox> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> API Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_5_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> API Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../api/python/ class=md-nav__link> <span class=md-ellipsis> Python API </span> </a> </li> <li class=md-nav__item> <a href=../../api/http/ class=md-nav__link> <span class=md-ellipsis> HTTP API </span> </a> </li> <li class=md-nav__item> <a href=../../api/graphql/ class=md-nav__link> <span class=md-ellipsis> GraphQL API </span> </a> </li> <li class=md-nav__item> <a href=../../api/quick-reference/ class=md-nav__link> <span class=md-ellipsis> Quick Reference </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_6 type=checkbox> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Examples </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_6_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../examples/basic_task/ class=md-nav__link> <span class=md-ellipsis> Basic Tasks </span> </a> </li> <li class=md-nav__item> <a href=../../examples/task-tree/ class=md-nav__link> <span class=md-ellipsis> Task Trees </span> </a> </li> <li class=md-nav__item> <a href=../../examples/real-world/ class=md-nav__link> <span class=md-ellipsis> Real World </span> </a> </li> <li class=md-nav__item> <a href=../../examples/email-executor/ class=md-nav__link> <span class=md-ellipsis> Email Executor </span> </a> </li> <li class=md-nav__item> <a href=../../examples/generate-executor/ class=md-nav__link> <span class=md-ellipsis> Generate Executor </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_7 type=checkbox> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Architecture </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_7_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../architecture/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/diagrams/ class=md-nav__link> <span class=md-ellipsis> Diagrams </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/directory-structure/ class=md-nav__link> <span class=md-ellipsis> Directory Structure </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/extension-registry-design/ class=md-nav__link> <span class=md-ellipsis> Extension Registry </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/task-manager/ class=md-nav__link> <span class=md-ellipsis> Task Manager </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/exception-handling/ class=md-nav__link> <span class=md-ellipsis> Exception Handling </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/configuration/ class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/task-tree-lifecycle/ class=md-nav__link> <span class=md-ellipsis> Task Tree Lifecycle </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_8 type=checkbox> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> Protocol </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_8_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Protocol </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../protocol/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../protocol/01-overview/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../protocol/02-core-concepts/ class=md-nav__link> <span class=md-ellipsis> Core Concepts </span> </a> </li> <li class=md-nav__item> <a href=../../protocol/03-data-model/ class=md-nav__link> <span class=md-ellipsis> Data Model </span> </a> </li> <li class=md-nav__item> <a href=../../protocol/04-execution-lifecycle/ class=md-nav__link> <span class=md-ellipsis> Execution Lifecycle </span> </a> </li> <li class=md-nav__item> <a href=../../protocol/05-examples/ class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=../../protocol/06-interfaces/ class=md-nav__link> <span class=md-ellipsis> Interfaces </span> </a> </li> <li class=md-nav__item> <a href=../../protocol/07-conformance/ class=md-nav__link> <span class=md-ellipsis> Conformance </span> </a> </li> <li class=md-nav__item> <a href=../../protocol/08-errors/ class=md-nav__link> <span class=md-ellipsis> Errors </span> </a> </li> <li class=md-nav__item> <a href=../../protocol/09-validation/ class=md-nav__link> <span class=md-ellipsis> Validation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_9 type=checkbox> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex=0> <span class=md-ellipsis> Development </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_9_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Development </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../development/setup/ class=md-nav__link> <span class=md-ellipsis> Setup </span> </a> </li> <li class=md-nav__item> <a href=../../development/contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=../../development/roadmap/ class=md-nav__link> <span class=md-ellipsis> Roadmap </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_9_4 type=checkbox> <label class=md-nav__link for=__nav_9_4 id=__nav_9_4_label tabindex=0> <span class=md-ellipsis> Design </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_9_4_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_9_4> <span class="md-nav__icon md-icon"></span> Design </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../development/design/cli-design/ class=md-nav__link> <span class=md-ellipsis> CLI Design </span> </a> </li> <li class=md-nav__item> <a href=../../development/design/aggregate-results-design/ class=md-nav__link> <span class=md-ellipsis> Aggregate Results </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=#what-youll-learn> <span class=md-ellipsis> What You'll Learn </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#table-of-contents> <span class=md-ellipsis> Table of Contents </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#core-concepts> <span class=md-ellipsis> Core Concepts </span> </a> <nav aria-label="Core Concepts" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#what-is-task-orchestration> <span class=md-ellipsis> What is Task Orchestration? </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#key-components> <span class=md-ellipsis> Key Components </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#task-tree-structure> <span class=md-ellipsis> Task Tree Structure </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#critical-distinction-parent-child-vs-dependencies> <span class=md-ellipsis> Critical Distinction: Parent-Child vs Dependencies </span> </a> <nav aria-label="Critical Distinction: Parent-Child vs Dependencies" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#parent-child-relationship-parent_id> <span class=md-ellipsis> Parent-Child Relationship (parent_id) </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#dependencies-dependencies> <span class=md-ellipsis> Dependencies (dependencies) </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#combined-example> <span class=md-ellipsis> Combined Example </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#task-lifecycle> <span class=md-ellipsis> Task Lifecycle </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#creating-task-trees> <span class=md-ellipsis> Creating Task Trees </span> </a> <nav aria-label="Creating Task Trees" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#basic-task-tree> <span class=md-ellipsis> Basic Task Tree </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#hierarchical-task-tree> <span class=md-ellipsis> Hierarchical Task Tree </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#dependencies> <span class=md-ellipsis> Dependencies </span> </a> <nav aria-label=Dependencies class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#dependency-resolution-flow> <span class=md-ellipsis> Dependency Resolution Flow </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#basic-dependency> <span class=md-ellipsis> Basic Dependency </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#sequential-pipeline> <span class=md-ellipsis> Sequential Pipeline </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#multiple-dependencies> <span class=md-ellipsis> Multiple Dependencies </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#dependency-types> <span class=md-ellipsis> Dependency Types </span> </a> <nav aria-label="Dependency Types" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#required-dependencies> <span class=md-ellipsis> Required Dependencies </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#optional-dependencies> <span class=md-ellipsis> Optional Dependencies </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#priorities> <span class=md-ellipsis> Priorities </span> </a> <nav aria-label=Priorities class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#priority-levels> <span class=md-ellipsis> Priority Levels </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#basic-priority> <span class=md-ellipsis> Basic Priority </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#priority-with-dependencies> <span class=md-ellipsis> Priority with Dependencies </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#priority-best-practices> <span class=md-ellipsis> Priority Best Practices </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#common-patterns> <span class=md-ellipsis> Common Patterns </span> </a> <nav aria-label="Common Patterns" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pattern-1-sequential-pipeline> <span class=md-ellipsis> Pattern 1: Sequential Pipeline </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pattern-2-fan-out-parallel> <span class=md-ellipsis> Pattern 2: Fan-Out (Parallel) </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pattern-3-fan-in-converge> <span class=md-ellipsis> Pattern 3: Fan-In (Converge) </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pattern-4-complex-workflow> <span class=md-ellipsis> Pattern 4: Complex Workflow </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pattern-5-conditional-execution> <span class=md-ellipsis> Pattern 5: Conditional Execution </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#best-practices> <span class=md-ellipsis> Best Practices </span> </a> <nav aria-label="Best Practices" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#1-use-meaningful-task-names> <span class=md-ellipsis> 1. Use Meaningful Task Names </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#2-set-appropriate-priorities> <span class=md-ellipsis> 2. Set Appropriate Priorities </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#3-handle-dependencies-explicitly> <span class=md-ellipsis> 3. Handle Dependencies Explicitly </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#4-use-parent-child-for-organization-dependencies-for-execution> <span class=md-ellipsis> 4. Use Parent-Child for Organization, Dependencies for Execution </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#5-handle-errors-gracefully> <span class=md-ellipsis> 5. Handle Errors Gracefully </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#6-keep-task-trees-manageable> <span class=md-ellipsis> 6. Keep Task Trees Manageable </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#task-cancellation> <span class=md-ellipsis> Task Cancellation </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#task-re-execution> <span class=md-ellipsis> Task Re-execution </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#streaming-execution> <span class=md-ellipsis> Streaming Execution </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#dependency-resolution> <span class=md-ellipsis> Dependency Resolution </span> </a> <nav aria-label="Dependency Resolution" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#copy-link-and-snapshot-behavior> <span class=md-ellipsis> Copy, Link, and Snapshot Behavior </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#next-steps> <span class=md-ellipsis> Next Steps </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#task-data-fields-inputs-params-and-result> <span class=md-ellipsis> Task Data Fields: inputs, params, and result </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=task-orchestration-guide>Task Orchestration Guide<a class=headerlink href=#task-orchestration-guide title="Permanent link">¶</a></h1> <p>Master task orchestration in apflow. Learn how to create complex workflows, manage dependencies, and optimize execution.</p> <h2 id=what-youll-learn>What You'll Learn<a class=headerlink href=#what-youll-learn title="Permanent link">¶</a></h2> <ul> <li>✅ How to build task trees and hierarchies</li> <li>✅ How dependencies control execution order</li> <li>✅ How priorities affect scheduling</li> <li>✅ Common patterns and best practices</li> <li>✅ Advanced orchestration techniques</li> </ul> <h2 id=table-of-contents>Table of Contents<a class=headerlink href=#table-of-contents title="Permanent link">¶</a></h2> <ol> <li><a href=#core-concepts>Core Concepts</a></li> <li><a href=#creating-task-trees>Creating Task Trees</a></li> <li><a href=#dependencies>Dependencies</a></li> <li><a href=#priorities>Priorities</a></li> <li><a href=#common-patterns>Common Patterns</a></li> <li><a href=#best-practices>Best Practices</a></li> <li><a href=#advanced-topics>Advanced Topics</a></li> <li><a href=#task-copy-and-re-execution>Task Copy and Re-execution</a></li> <li><a href=#task-re-execution>Task Re-execution</a></li> </ol> <h2 id=core-concepts>Core Concepts<a class=headerlink href=#core-concepts title="Permanent link">¶</a></h2> <h3 id=what-is-task-orchestration>What is Task Orchestration?<a class=headerlink href=#what-is-task-orchestration title="Permanent link">¶</a></h3> <p>Task orchestration is the process of coordinating multiple tasks to work together. Think of it like conducting an orchestra - each musician (task) plays their part, but the conductor (TaskManager) ensures they play in harmony.</p> <h3 id=key-components>Key Components<a class=headerlink href=#key-components title="Permanent link">¶</a></h3> <p><strong>TaskManager</strong>: The orchestrator that coordinates everything - Manages task execution - Resolves dependencies - Handles priorities - Tracks status</p> <p><strong>Task</strong>: A unit of work - Has an executor (the code that runs) - Has inputs (parameters) - Has a status (pending → in_progress → completed)</p> <p><strong>Task Tree</strong>: The structure that organizes tasks - Hierarchical (parent-child relationships) - Can have dependencies (execution order) - Can have priorities (scheduling)</p> <h3 id=task-tree-structure>Task Tree Structure<a class=headerlink href=#task-tree-structure title="Permanent link">¶</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a>Root Task
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>│
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>├── Child Task 1 (depends on nothing)
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>│   │
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>│   └── Grandchild Task 1.1 (depends on Child Task 1)
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>│
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>├── Child Task 2 (depends on nothing, runs in parallel with Child Task 1)
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>│
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>└── Child Task 3 (depends on Child Task 1 and Child Task 2)
</span></code></pre></div> <h3 id=critical-distinction-parent-child-vs-dependencies>Critical Distinction: Parent-Child vs Dependencies<a class=headerlink href=#critical-distinction-parent-child-vs-dependencies title="Permanent link">¶</a></h3> <p><strong>⚠️ This is the most important concept to understand!</strong></p> <h4 id=parent-child-relationship-parent_id>Parent-Child Relationship (<code>parent_id</code>)<a class=headerlink href=#parent-child-relationship-parent_id title="Permanent link">¶</a></h4> <p><strong>Purpose</strong>: Organization only - like folders in a file system</p> <ul> <li>Used to <strong>organize</strong> the task tree structure</li> <li>Helps visualize the hierarchy</li> <li><strong>Does NOT affect execution order</strong></li> <li>Purely organizational</li> </ul> <p><strong>Example:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a href=#__codelineno-1-1 id=__codelineno-1-1 name=__codelineno-1-1></a><span class=c1># Task B is a child of Task A (organizational)</span>
</span><span id=__span-1-2><a href=#__codelineno-1-2 id=__codelineno-1-2 name=__codelineno-1-2></a><span class=n>task_a</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"task_a"</span><span class=p>)</span>
</span><span id=__span-1-3><a href=#__codelineno-1-3 id=__codelineno-1-3 name=__codelineno-1-3></a><span class=n>task_b</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"task_b"</span><span class=p>,</span> <span class=n>parent_id</span><span class=o>=</span><span class=n>task_a</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>  <span class=c1># Child of A</span>
</span></code></pre></div></p> <h4 id=dependencies-dependencies>Dependencies (<code>dependencies</code>)<a class=headerlink href=#dependencies-dependencies title="Permanent link">¶</a></h4> <p><strong>Purpose</strong>: Execution control - determines when tasks run</p> <ul> <li><strong>Determines execution order</strong></li> <li>A task waits for its dependencies to complete</li> <li>Controls the actual execution sequence</li> <li><strong>This is what makes tasks wait for each other</strong></li> </ul> <p><strong>Example:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-2-1><a href=#__codelineno-2-1 id=__codelineno-2-1 name=__codelineno-2-1></a><span class=c1># Task B depends on Task C (execution order)</span>
</span><span id=__span-2-2><a href=#__codelineno-2-2 id=__codelineno-2-2 name=__codelineno-2-2></a><span class=n>task_c</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"task_c"</span><span class=p>)</span>
</span><span id=__span-2-3><a href=#__codelineno-2-3 id=__codelineno-2-3 name=__codelineno-2-3></a><span class=n>task_b</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-2-4><a href=#__codelineno-2-4 id=__codelineno-2-4 name=__codelineno-2-4></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"task_b"</span><span class=p>,</span>
</span><span id=__span-2-5><a href=#__codelineno-2-5 id=__codelineno-2-5 name=__codelineno-2-5></a>    <span class=n>dependencies</span><span class=o>=</span><span class=p>[{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>task_c</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>True</span><span class=p>}]</span>  <span class=c1># Waits for C</span>
</span><span id=__span-2-6><a href=#__codelineno-2-6 id=__codelineno-2-6 name=__codelineno-2-6></a><span class=p>)</span>
</span><span id=__span-2-7><a href=#__codelineno-2-7 id=__codelineno-2-7 name=__codelineno-2-7></a><span class=c1># Execution order: C runs first, then B</span>
</span></code></pre></div></p> <h4 id=combined-example>Combined Example<a class=headerlink href=#combined-example title="Permanent link">¶</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-3-1><a href=#__codelineno-3-1 id=__codelineno-3-1 name=__codelineno-3-1></a><span class=c1># Task B is a child of Task A (organizational)</span>
</span><span id=__span-3-2><a href=#__codelineno-3-2 id=__codelineno-3-2 name=__codelineno-3-2></a><span class=c1># But Task B depends on Task C (execution order)</span>
</span><span id=__span-3-3><a href=#__codelineno-3-3 id=__codelineno-3-3 name=__codelineno-3-3></a><span class=n>task_a</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"task_a"</span><span class=p>)</span>
</span><span id=__span-3-4><a href=#__codelineno-3-4 id=__codelineno-3-4 name=__codelineno-3-4></a><span class=n>task_c</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"task_c"</span><span class=p>)</span>
</span><span id=__span-3-5><a href=#__codelineno-3-5 id=__codelineno-3-5 name=__codelineno-3-5></a><span class=n>task_b</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-3-6><a href=#__codelineno-3-6 id=__codelineno-3-6 name=__codelineno-3-6></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"task_b"</span><span class=p>,</span>
</span><span id=__span-3-7><a href=#__codelineno-3-7 id=__codelineno-3-7 name=__codelineno-3-7></a>    <span class=n>parent_id</span><span class=o>=</span><span class=n>task_a</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>  <span class=c1># Organizational: B is child of A</span>
</span><span id=__span-3-8><a href=#__codelineno-3-8 id=__codelineno-3-8 name=__codelineno-3-8></a>    <span class=n>dependencies</span><span class=o>=</span><span class=p>[{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>task_c</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>True</span><span class=p>}]</span>  <span class=c1># Execution: B waits for C</span>
</span><span id=__span-3-9><a href=#__codelineno-3-9 id=__codelineno-3-9 name=__codelineno-3-9></a><span class=p>)</span>
</span><span id=__span-3-10><a href=#__codelineno-3-10 id=__codelineno-3-10 name=__codelineno-3-10></a><span class=c1># Execution order: C executes first, then B (regardless of parent-child)</span>
</span></code></pre></div> <p><strong>Visual Representation:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-4-1><a href=#__codelineno-4-1 id=__codelineno-4-1 name=__codelineno-4-1></a>Task A (root)
</span><span id=__span-4-2><a href=#__codelineno-4-2 id=__codelineno-4-2 name=__codelineno-4-2></a>│
</span><span id=__span-4-3><a href=#__codelineno-4-3 id=__codelineno-4-3 name=__codelineno-4-3></a>└── Task B (child of A, but depends on C)
</span><span id=__span-4-4><a href=#__codelineno-4-4 id=__codelineno-4-4 name=__codelineno-4-4></a>    │
</span><span id=__span-4-5><a href=#__codelineno-4-5 id=__codelineno-4-5 name=__codelineno-4-5></a>    └── (depends on) Task C (not a child, but must run first!)
</span></code></pre></div></p> <p><strong>Key Takeaway</strong>: - Use <code>parent_id</code> for <strong>organization</strong> (like folders) - Use <code>dependencies</code> for <strong>execution order</strong> (when tasks run)</p> <h3 id=task-lifecycle>Task Lifecycle<a class=headerlink href=#task-lifecycle title="Permanent link">¶</a></h3> <p>Tasks go through these states:</p> <pre class=mermaid><code>stateDiagram-v2
    [*] --&gt; pending: Task Created

    pending --&gt; in_progress: Execution Started
    pending --&gt; cancelled: User Cancellation

    in_progress --&gt; completed: Execution Successful
    in_progress --&gt; failed: Execution Failed
    in_progress --&gt; cancelled: User Cancellation

    completed --&gt; [*]: Task Finished
    failed --&gt; [*]: Task Finished
    cancelled --&gt; [*]: Task Finished

    note right of pending
        Initial state after task creation.
        Waiting for dependencies to be satisfied.
    end note

    note right of in_progress
        Task is currently executing.
        Executor is running the task logic.
    end note

    note right of completed
        Task finished successfully.
        Result is available in task.result.
    end note

    note right of failed
        Task execution failed.
        Error details in task.error.
    end note

    note right of cancelled
        Task was cancelled before completion.
        Can be cancelled from any active state.
    end note</code></pre> <p><strong>Status Meanings:</strong> - <strong>pending</strong>: Created but not executed yet - <strong>in_progress</strong>: Currently executing - <strong>completed</strong>: Finished successfully - <strong>failed</strong>: Execution failed (check <code>task.error</code>) - <strong>cancelled</strong>: Was cancelled (check <code>task.error</code>)</p> <h2 id=creating-task-trees>Creating Task Trees<a class=headerlink href=#creating-task-trees title="Permanent link">¶</a></h2> <h3 id=basic-task-tree>Basic Task Tree<a class=headerlink href=#basic-task-tree title="Permanent link">¶</a></h3> <p>The simplest possible tree - a single task:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-5-1><a href=#__codelineno-5-1 id=__codelineno-5-1 name=__codelineno-5-1></a><span class=kn>import</span><span class=w> </span><span class=nn>asyncio</span>
</span><span id=__span-5-2><a href=#__codelineno-5-2 id=__codelineno-5-2 name=__codelineno-5-2></a><span class=kn>from</span><span class=w> </span><span class=nn>apflow</span><span class=w> </span><span class=kn>import</span> <span class=n>TaskManager</span><span class=p>,</span> <span class=n>TaskTreeNode</span><span class=p>,</span> <span class=n>create_session</span>
</span><span id=__span-5-3><a href=#__codelineno-5-3 id=__codelineno-5-3 name=__codelineno-5-3></a>
</span><span id=__span-5-4><a href=#__codelineno-5-4 id=__codelineno-5-4 name=__codelineno-5-4></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>main</span><span class=p>():</span>
</span><span id=__span-5-5><a href=#__codelineno-5-5 id=__codelineno-5-5 name=__codelineno-5-5></a>    <span class=n>db</span> <span class=o>=</span> <span class=n>create_session</span><span class=p>()</span>
</span><span id=__span-5-6><a href=#__codelineno-5-6 id=__codelineno-5-6 name=__codelineno-5-6></a>    <span class=n>task_manager</span> <span class=o>=</span> <span class=n>TaskManager</span><span class=p>(</span><span class=n>db</span><span class=p>)</span>
</span><span id=__span-5-7><a href=#__codelineno-5-7 id=__codelineno-5-7 name=__codelineno-5-7></a>
</span><span id=__span-5-8><a href=#__codelineno-5-8 id=__codelineno-5-8 name=__codelineno-5-8></a>    <span class=c1># Create a task</span>
</span><span id=__span-5-9><a href=#__codelineno-5-9 id=__codelineno-5-9 name=__codelineno-5-9></a>    <span class=n>task</span> <span class=o>=</span> <span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>task_repository</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-5-10><a href=#__codelineno-5-10 id=__codelineno-5-10 name=__codelineno-5-10></a>        <span class=n>name</span><span class=o>=</span><span class=s2>"system_info_executor"</span><span class=p>,</span>  <span class=c1># Executor ID</span>
</span><span id=__span-5-11><a href=#__codelineno-5-11 id=__codelineno-5-11 name=__codelineno-5-11></a>        <span class=n>user_id</span><span class=o>=</span><span class=s2>"user123"</span><span class=p>,</span>
</span><span id=__span-5-12><a href=#__codelineno-5-12 id=__codelineno-5-12 name=__codelineno-5-12></a>        <span class=n>priority</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-5-13><a href=#__codelineno-5-13 id=__codelineno-5-13 name=__codelineno-5-13></a>        <span class=n>inputs</span><span class=o>=</span><span class=p>{</span><span class=s2>"resource"</span><span class=p>:</span> <span class=s2>"cpu"</span><span class=p>}</span>
</span><span id=__span-5-14><a href=#__codelineno-5-14 id=__codelineno-5-14 name=__codelineno-5-14></a>    <span class=p>)</span>
</span><span id=__span-5-15><a href=#__codelineno-5-15 id=__codelineno-5-15 name=__codelineno-5-15></a>
</span><span id=__span-5-16><a href=#__codelineno-5-16 id=__codelineno-5-16 name=__codelineno-5-16></a>    <span class=c1># Build task tree (even single tasks need a tree)</span>
</span><span id=__span-5-17><a href=#__codelineno-5-17 id=__codelineno-5-17 name=__codelineno-5-17></a>    <span class=n>task_tree</span> <span class=o>=</span> <span class=n>TaskTreeNode</span><span class=p>(</span><span class=n>task</span><span class=p>)</span>
</span><span id=__span-5-18><a href=#__codelineno-5-18 id=__codelineno-5-18 name=__codelineno-5-18></a>
</span><span id=__span-5-19><a href=#__codelineno-5-19 id=__codelineno-5-19 name=__codelineno-5-19></a>    <span class=c1># Execute</span>
</span><span id=__span-5-20><a href=#__codelineno-5-20 id=__codelineno-5-20 name=__codelineno-5-20></a>    <span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>distribute_task_tree</span><span class=p>(</span><span class=n>task_tree</span><span class=p>)</span>
</span><span id=__span-5-21><a href=#__codelineno-5-21 id=__codelineno-5-21 name=__codelineno-5-21></a>
</span><span id=__span-5-22><a href=#__codelineno-5-22 id=__codelineno-5-22 name=__codelineno-5-22></a>    <span class=c1># Get result</span>
</span><span id=__span-5-23><a href=#__codelineno-5-23 id=__codelineno-5-23 name=__codelineno-5-23></a>    <span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>task_repository</span><span class=o>.</span><span class=n>get_task_by_id</span><span class=p>(</span><span class=n>task</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
</span><span id=__span-5-24><a href=#__codelineno-5-24 id=__codelineno-5-24 name=__codelineno-5-24></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Status: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>status</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-5-25><a href=#__codelineno-5-25 id=__codelineno-5-25 name=__codelineno-5-25></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Result: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>result</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-5-26><a href=#__codelineno-5-26 id=__codelineno-5-26 name=__codelineno-5-26></a>
</span><span id=__span-5-27><a href=#__codelineno-5-27 id=__codelineno-5-27 name=__codelineno-5-27></a><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>"__main__"</span><span class=p>:</span>
</span><span id=__span-5-28><a href=#__codelineno-5-28 id=__codelineno-5-28 name=__codelineno-5-28></a>    <span class=n>asyncio</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>main</span><span class=p>())</span>
</span></code></pre></div> <h3 id=hierarchical-task-tree>Hierarchical Task Tree<a class=headerlink href=#hierarchical-task-tree title="Permanent link">¶</a></h3> <p>Create a tree with parent-child relationships:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-6-1><a href=#__codelineno-6-1 id=__codelineno-6-1 name=__codelineno-6-1></a><span class=c1># Create root task</span>
</span><span id=__span-6-2><a href=#__codelineno-6-2 id=__codelineno-6-2 name=__codelineno-6-2></a><span class=n>root_task</span> <span class=o>=</span> <span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>task_repository</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-6-3><a href=#__codelineno-6-3 id=__codelineno-6-3 name=__codelineno-6-3></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"root_task"</span><span class=p>,</span>
</span><span id=__span-6-4><a href=#__codelineno-6-4 id=__codelineno-6-4 name=__codelineno-6-4></a>    <span class=n>user_id</span><span class=o>=</span><span class=s2>"user123"</span><span class=p>,</span>
</span><span id=__span-6-5><a href=#__codelineno-6-5 id=__codelineno-6-5 name=__codelineno-6-5></a>    <span class=n>priority</span><span class=o>=</span><span class=mi>1</span>
</span><span id=__span-6-6><a href=#__codelineno-6-6 id=__codelineno-6-6 name=__codelineno-6-6></a><span class=p>)</span>
</span><span id=__span-6-7><a href=#__codelineno-6-7 id=__codelineno-6-7 name=__codelineno-6-7></a>
</span><span id=__span-6-8><a href=#__codelineno-6-8 id=__codelineno-6-8 name=__codelineno-6-8></a><span class=c1># Create child tasks</span>
</span><span id=__span-6-9><a href=#__codelineno-6-9 id=__codelineno-6-9 name=__codelineno-6-9></a><span class=n>child1</span> <span class=o>=</span> <span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>task_repository</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-6-10><a href=#__codelineno-6-10 id=__codelineno-6-10 name=__codelineno-6-10></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"child_task_1"</span><span class=p>,</span>
</span><span id=__span-6-11><a href=#__codelineno-6-11 id=__codelineno-6-11 name=__codelineno-6-11></a>    <span class=n>user_id</span><span class=o>=</span><span class=s2>"user123"</span><span class=p>,</span>
</span><span id=__span-6-12><a href=#__codelineno-6-12 id=__codelineno-6-12 name=__codelineno-6-12></a>    <span class=n>parent_id</span><span class=o>=</span><span class=n>root_task</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>  <span class=c1># Child of root</span>
</span><span id=__span-6-13><a href=#__codelineno-6-13 id=__codelineno-6-13 name=__codelineno-6-13></a>    <span class=n>priority</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-6-14><a href=#__codelineno-6-14 id=__codelineno-6-14 name=__codelineno-6-14></a>    <span class=n>inputs</span><span class=o>=</span><span class=p>{</span><span class=s2>"step"</span><span class=p>:</span> <span class=mi>1</span><span class=p>}</span>
</span><span id=__span-6-15><a href=#__codelineno-6-15 id=__codelineno-6-15 name=__codelineno-6-15></a><span class=p>)</span>
</span><span id=__span-6-16><a href=#__codelineno-6-16 id=__codelineno-6-16 name=__codelineno-6-16></a>
</span><span id=__span-6-17><a href=#__codelineno-6-17 id=__codelineno-6-17 name=__codelineno-6-17></a><span class=n>child2</span> <span class=o>=</span> <span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>task_repository</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-6-18><a href=#__codelineno-6-18 id=__codelineno-6-18 name=__codelineno-6-18></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"child_task_2"</span><span class=p>,</span>
</span><span id=__span-6-19><a href=#__codelineno-6-19 id=__codelineno-6-19 name=__codelineno-6-19></a>    <span class=n>user_id</span><span class=o>=</span><span class=s2>"user123"</span><span class=p>,</span>
</span><span id=__span-6-20><a href=#__codelineno-6-20 id=__codelineno-6-20 name=__codelineno-6-20></a>    <span class=n>parent_id</span><span class=o>=</span><span class=n>root_task</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>  <span class=c1># Also child of root</span>
</span><span id=__span-6-21><a href=#__codelineno-6-21 id=__codelineno-6-21 name=__codelineno-6-21></a>    <span class=n>priority</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-6-22><a href=#__codelineno-6-22 id=__codelineno-6-22 name=__codelineno-6-22></a>    <span class=n>inputs</span><span class=o>=</span><span class=p>{</span><span class=s2>"step"</span><span class=p>:</span> <span class=mi>2</span><span class=p>}</span>
</span><span id=__span-6-23><a href=#__codelineno-6-23 id=__codelineno-6-23 name=__codelineno-6-23></a><span class=p>)</span>
</span><span id=__span-6-24><a href=#__codelineno-6-24 id=__codelineno-6-24 name=__codelineno-6-24></a>
</span><span id=__span-6-25><a href=#__codelineno-6-25 id=__codelineno-6-25 name=__codelineno-6-25></a><span class=c1># Build tree</span>
</span><span id=__span-6-26><a href=#__codelineno-6-26 id=__codelineno-6-26 name=__codelineno-6-26></a><span class=n>root</span> <span class=o>=</span> <span class=n>TaskTreeNode</span><span class=p>(</span><span class=n>root_task</span><span class=p>)</span>
</span><span id=__span-6-27><a href=#__codelineno-6-27 id=__codelineno-6-27 name=__codelineno-6-27></a><span class=n>root</span><span class=o>.</span><span class=n>add_child</span><span class=p>(</span><span class=n>TaskTreeNode</span><span class=p>(</span><span class=n>child1</span><span class=p>))</span>
</span><span id=__span-6-28><a href=#__codelineno-6-28 id=__codelineno-6-28 name=__codelineno-6-28></a><span class=n>root</span><span class=o>.</span><span class=n>add_child</span><span class=p>(</span><span class=n>TaskTreeNode</span><span class=p>(</span><span class=n>child2</span><span class=p>))</span>
</span><span id=__span-6-29><a href=#__codelineno-6-29 id=__codelineno-6-29 name=__codelineno-6-29></a>
</span><span id=__span-6-30><a href=#__codelineno-6-30 id=__codelineno-6-30 name=__codelineno-6-30></a><span class=c1># Execute</span>
</span><span id=__span-6-31><a href=#__codelineno-6-31 id=__codelineno-6-31 name=__codelineno-6-31></a><span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>distribute_task_tree</span><span class=p>(</span><span class=n>root</span><span class=p>)</span>
</span></code></pre></div> <p><strong>Visual Structure:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-7-1><a href=#__codelineno-7-1 id=__codelineno-7-1 name=__codelineno-7-1></a>Root Task
</span><span id=__span-7-2><a href=#__codelineno-7-2 id=__codelineno-7-2 name=__codelineno-7-2></a>│
</span><span id=__span-7-3><a href=#__codelineno-7-3 id=__codelineno-7-3 name=__codelineno-7-3></a>├── Child Task 1
</span><span id=__span-7-4><a href=#__codelineno-7-4 id=__codelineno-7-4 name=__codelineno-7-4></a>└── Child Task 2
</span></code></pre></div></p> <h2 id=dependencies>Dependencies<a class=headerlink href=#dependencies title="Permanent link">¶</a></h2> <p>Dependencies are the mechanism that controls execution order. They ensure tasks run in the correct sequence.</p> <h3 id=dependency-resolution-flow>Dependency Resolution Flow<a class=headerlink href=#dependency-resolution-flow title="Permanent link">¶</a></h3> <p>The following diagram illustrates how the system resolves task dependencies:</p> <pre class=mermaid><code>flowchart TD
    Start([Task Ready to Execute]) --&gt; GetDeps[Get Task Dependencies]
    GetDeps --&gt; HasDeps{Has&lt;br/&gt;Dependencies?}

    HasDeps --&gt;|No| ExecuteTask[Execute Task Immediately]
    HasDeps --&gt;|Yes| CheckDepStatus[Check Each Dependency Status]

    CheckDepStatus --&gt; AllRequiredComplete{All Required&lt;br/&gt;Dependencies&lt;br/&gt;Complete?}

    AllRequiredComplete --&gt;|No| CheckOptional{Has Optional&lt;br/&gt;Dependencies?}
    AllRequiredComplete --&gt;|Yes| MergeResults[Merge Dependency Results]

    CheckOptional --&gt;|Yes| CheckOptionalStatus{Optional Dependencies&lt;br/&gt;Complete or Failed?}
    CheckOptional --&gt;|No| WaitForDeps[Wait for Required Dependencies]

    CheckOptionalStatus --&gt;|Complete| MergeResults
    CheckOptionalStatus --&gt;|Failed| MergeResults
    CheckOptionalStatus --&gt;|In Progress| WaitForDeps

    WaitForDeps --&gt; CheckDepStatus

    MergeResults --&gt; CollectResults[Collect Results from Dependencies]
    CollectResults --&gt; MergeWithInputs[Merge with Task Inputs]

    MergeWithInputs --&gt; ExecuteTask

    ExecuteTask --&gt; TaskComplete([Task Execution Complete])

    style Start fill:#e1f5ff
    style ExecuteTask fill:#c8e6c9
    style TaskComplete fill:#c8e6c9
    style WaitForDeps fill:#fff9c4
    style MergeResults fill:#e1bee7</code></pre> <h3 id=basic-dependency>Basic Dependency<a class=headerlink href=#basic-dependency title="Permanent link">¶</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-8-1><a href=#__codelineno-8-1 id=__codelineno-8-1 name=__codelineno-8-1></a><span class=c1># Task 1: Fetch data</span>
</span><span id=__span-8-2><a href=#__codelineno-8-2 id=__codelineno-8-2 name=__codelineno-8-2></a><span class=n>fetch_task</span> <span class=o>=</span> <span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>task_repository</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-8-3><a href=#__codelineno-8-3 id=__codelineno-8-3 name=__codelineno-8-3></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"fetch_data"</span><span class=p>,</span>
</span><span id=__span-8-4><a href=#__codelineno-8-4 id=__codelineno-8-4 name=__codelineno-8-4></a>    <span class=n>user_id</span><span class=o>=</span><span class=s2>"user123"</span><span class=p>,</span>
</span><span id=__span-8-5><a href=#__codelineno-8-5 id=__codelineno-8-5 name=__codelineno-8-5></a>    <span class=n>priority</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-8-6><a href=#__codelineno-8-6 id=__codelineno-8-6 name=__codelineno-8-6></a>    <span class=n>inputs</span><span class=o>=</span><span class=p>{</span><span class=s2>"url"</span><span class=p>:</span> <span class=s2>"https://api.example.com/data"</span><span class=p>}</span>
</span><span id=__span-8-7><a href=#__codelineno-8-7 id=__codelineno-8-7 name=__codelineno-8-7></a><span class=p>)</span>
</span><span id=__span-8-8><a href=#__codelineno-8-8 id=__codelineno-8-8 name=__codelineno-8-8></a>
</span><span id=__span-8-9><a href=#__codelineno-8-9 id=__codelineno-8-9 name=__codelineno-8-9></a><span class=c1># Task 2: Process data (depends on Task 1)</span>
</span><span id=__span-8-10><a href=#__codelineno-8-10 id=__codelineno-8-10 name=__codelineno-8-10></a><span class=n>process_task</span> <span class=o>=</span> <span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>task_repository</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-8-11><a href=#__codelineno-8-11 id=__codelineno-8-11 name=__codelineno-8-11></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"process_data"</span><span class=p>,</span>
</span><span id=__span-8-12><a href=#__codelineno-8-12 id=__codelineno-8-12 name=__codelineno-8-12></a>    <span class=n>user_id</span><span class=o>=</span><span class=s2>"user123"</span><span class=p>,</span>
</span><span id=__span-8-13><a href=#__codelineno-8-13 id=__codelineno-8-13 name=__codelineno-8-13></a>    <span class=n>parent_id</span><span class=o>=</span><span class=n>fetch_task</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
</span><span id=__span-8-14><a href=#__codelineno-8-14 id=__codelineno-8-14 name=__codelineno-8-14></a>    <span class=n>dependencies</span><span class=o>=</span><span class=p>[{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>fetch_task</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>True</span><span class=p>}],</span>  <span class=c1># Waits for fetch_task</span>
</span><span id=__span-8-15><a href=#__codelineno-8-15 id=__codelineno-8-15 name=__codelineno-8-15></a>    <span class=n>priority</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-8-16><a href=#__codelineno-8-16 id=__codelineno-8-16 name=__codelineno-8-16></a>    <span class=n>inputs</span><span class=o>=</span><span class=p>{</span><span class=s2>"operation"</span><span class=p>:</span> <span class=s2>"analyze"</span><span class=p>}</span>
</span><span id=__span-8-17><a href=#__codelineno-8-17 id=__codelineno-8-17 name=__codelineno-8-17></a><span class=p>)</span>
</span><span id=__span-8-18><a href=#__codelineno-8-18 id=__codelineno-8-18 name=__codelineno-8-18></a>
</span><span id=__span-8-19><a href=#__codelineno-8-19 id=__codelineno-8-19 name=__codelineno-8-19></a><span class=c1># Build tree</span>
</span><span id=__span-8-20><a href=#__codelineno-8-20 id=__codelineno-8-20 name=__codelineno-8-20></a><span class=n>task_tree</span> <span class=o>=</span> <span class=n>TaskTreeNode</span><span class=p>(</span><span class=n>fetch_task</span><span class=p>)</span>
</span><span id=__span-8-21><a href=#__codelineno-8-21 id=__codelineno-8-21 name=__codelineno-8-21></a><span class=n>task_tree</span><span class=o>.</span><span class=n>add_child</span><span class=p>(</span><span class=n>TaskTreeNode</span><span class=p>(</span><span class=n>process_task</span><span class=p>))</span>
</span><span id=__span-8-22><a href=#__codelineno-8-22 id=__codelineno-8-22 name=__codelineno-8-22></a>
</span><span id=__span-8-23><a href=#__codelineno-8-23 id=__codelineno-8-23 name=__codelineno-8-23></a><span class=c1># Execute</span>
</span><span id=__span-8-24><a href=#__codelineno-8-24 id=__codelineno-8-24 name=__codelineno-8-24></a><span class=c1># Execution order: fetch_task → process_task (automatic!)</span>
</span><span id=__span-8-25><a href=#__codelineno-8-25 id=__codelineno-8-25 name=__codelineno-8-25></a><span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>distribute_task_tree</span><span class=p>(</span><span class=n>task_tree</span><span class=p>)</span>
</span></code></pre></div> <p><strong>Execution Flow:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-9-1><a href=#__codelineno-9-1 id=__codelineno-9-1 name=__codelineno-9-1></a>Fetch Task (runs first)
</span><span id=__span-9-2><a href=#__codelineno-9-2 id=__codelineno-9-2 name=__codelineno-9-2></a>    ↓
</span><span id=__span-9-3><a href=#__codelineno-9-3 id=__codelineno-9-3 name=__codelineno-9-3></a>Process Task (waits for Fetch, then runs)
</span></code></pre></div></p> <h3 id=sequential-pipeline>Sequential Pipeline<a class=headerlink href=#sequential-pipeline title="Permanent link">¶</a></h3> <p>Create a pipeline where each task depends on the previous:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-10-1><a href=#__codelineno-10-1 id=__codelineno-10-1 name=__codelineno-10-1></a><span class=c1># Step 1: Fetch</span>
</span><span id=__span-10-2><a href=#__codelineno-10-2 id=__codelineno-10-2 name=__codelineno-10-2></a><span class=n>fetch</span> <span class=o>=</span> <span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>task_repository</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-10-3><a href=#__codelineno-10-3 id=__codelineno-10-3 name=__codelineno-10-3></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"fetch_data"</span><span class=p>,</span>
</span><span id=__span-10-4><a href=#__codelineno-10-4 id=__codelineno-10-4 name=__codelineno-10-4></a>    <span class=n>user_id</span><span class=o>=</span><span class=s2>"user123"</span><span class=p>,</span>
</span><span id=__span-10-5><a href=#__codelineno-10-5 id=__codelineno-10-5 name=__codelineno-10-5></a>    <span class=n>priority</span><span class=o>=</span><span class=mi>1</span>
</span><span id=__span-10-6><a href=#__codelineno-10-6 id=__codelineno-10-6 name=__codelineno-10-6></a><span class=p>)</span>
</span><span id=__span-10-7><a href=#__codelineno-10-7 id=__codelineno-10-7 name=__codelineno-10-7></a>
</span><span id=__span-10-8><a href=#__codelineno-10-8 id=__codelineno-10-8 name=__codelineno-10-8></a><span class=c1># Step 2: Process (depends on fetch)</span>
</span><span id=__span-10-9><a href=#__codelineno-10-9 id=__codelineno-10-9 name=__codelineno-10-9></a><span class=n>process</span> <span class=o>=</span> <span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>task_repository</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-10-10><a href=#__codelineno-10-10 id=__codelineno-10-10 name=__codelineno-10-10></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"process_data"</span><span class=p>,</span>
</span><span id=__span-10-11><a href=#__codelineno-10-11 id=__codelineno-10-11 name=__codelineno-10-11></a>    <span class=n>user_id</span><span class=o>=</span><span class=s2>"user123"</span><span class=p>,</span>
</span><span id=__span-10-12><a href=#__codelineno-10-12 id=__codelineno-10-12 name=__codelineno-10-12></a>    <span class=n>parent_id</span><span class=o>=</span><span class=n>fetch</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
</span><span id=__span-10-13><a href=#__codelineno-10-13 id=__codelineno-10-13 name=__codelineno-10-13></a>    <span class=n>dependencies</span><span class=o>=</span><span class=p>[{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>fetch</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>True</span><span class=p>}],</span>
</span><span id=__span-10-14><a href=#__codelineno-10-14 id=__codelineno-10-14 name=__codelineno-10-14></a>    <span class=n>priority</span><span class=o>=</span><span class=mi>2</span>
</span><span id=__span-10-15><a href=#__codelineno-10-15 id=__codelineno-10-15 name=__codelineno-10-15></a><span class=p>)</span>
</span><span id=__span-10-16><a href=#__codelineno-10-16 id=__codelineno-10-16 name=__codelineno-10-16></a>
</span><span id=__span-10-17><a href=#__codelineno-10-17 id=__codelineno-10-17 name=__codelineno-10-17></a><span class=c1># Step 3: Save (depends on process)</span>
</span><span id=__span-10-18><a href=#__codelineno-10-18 id=__codelineno-10-18 name=__codelineno-10-18></a><span class=n>save</span> <span class=o>=</span> <span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>task_repository</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-10-19><a href=#__codelineno-10-19 id=__codelineno-10-19 name=__codelineno-10-19></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"save_results"</span><span class=p>,</span>
</span><span id=__span-10-20><a href=#__codelineno-10-20 id=__codelineno-10-20 name=__codelineno-10-20></a>    <span class=n>user_id</span><span class=o>=</span><span class=s2>"user123"</span><span class=p>,</span>
</span><span id=__span-10-21><a href=#__codelineno-10-21 id=__codelineno-10-21 name=__codelineno-10-21></a>    <span class=n>parent_id</span><span class=o>=</span><span class=n>fetch</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
</span><span id=__span-10-22><a href=#__codelineno-10-22 id=__codelineno-10-22 name=__codelineno-10-22></a>    <span class=n>dependencies</span><span class=o>=</span><span class=p>[{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>process</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>True</span><span class=p>}],</span>
</span><span id=__span-10-23><a href=#__codelineno-10-23 id=__codelineno-10-23 name=__codelineno-10-23></a>    <span class=n>priority</span><span class=o>=</span><span class=mi>3</span>
</span><span id=__span-10-24><a href=#__codelineno-10-24 id=__codelineno-10-24 name=__codelineno-10-24></a><span class=p>)</span>
</span><span id=__span-10-25><a href=#__codelineno-10-25 id=__codelineno-10-25 name=__codelineno-10-25></a>
</span><span id=__span-10-26><a href=#__codelineno-10-26 id=__codelineno-10-26 name=__codelineno-10-26></a><span class=c1># Build pipeline</span>
</span><span id=__span-10-27><a href=#__codelineno-10-27 id=__codelineno-10-27 name=__codelineno-10-27></a><span class=n>root</span> <span class=o>=</span> <span class=n>TaskTreeNode</span><span class=p>(</span><span class=n>fetch</span><span class=p>)</span>
</span><span id=__span-10-28><a href=#__codelineno-10-28 id=__codelineno-10-28 name=__codelineno-10-28></a><span class=n>root</span><span class=o>.</span><span class=n>add_child</span><span class=p>(</span><span class=n>TaskTreeNode</span><span class=p>(</span><span class=n>process</span><span class=p>))</span>
</span><span id=__span-10-29><a href=#__codelineno-10-29 id=__codelineno-10-29 name=__codelineno-10-29></a><span class=n>root</span><span class=o>.</span><span class=n>add_child</span><span class=p>(</span><span class=n>TaskTreeNode</span><span class=p>(</span><span class=n>save</span><span class=p>))</span>
</span><span id=__span-10-30><a href=#__codelineno-10-30 id=__codelineno-10-30 name=__codelineno-10-30></a>
</span><span id=__span-10-31><a href=#__codelineno-10-31 id=__codelineno-10-31 name=__codelineno-10-31></a><span class=c1># Execute</span>
</span><span id=__span-10-32><a href=#__codelineno-10-32 id=__codelineno-10-32 name=__codelineno-10-32></a><span class=c1># Order: Fetch → Process → Save (automatic!)</span>
</span><span id=__span-10-33><a href=#__codelineno-10-33 id=__codelineno-10-33 name=__codelineno-10-33></a><span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>distribute_task_tree</span><span class=p>(</span><span class=n>root</span><span class=p>)</span>
</span></code></pre></div> <p><strong>Execution Flow:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-11-1><a href=#__codelineno-11-1 id=__codelineno-11-1 name=__codelineno-11-1></a>Fetch → Process → Save
</span></code></pre></div></p> <h3 id=multiple-dependencies>Multiple Dependencies<a class=headerlink href=#multiple-dependencies title="Permanent link">¶</a></h3> <p>A task can depend on multiple other tasks:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-12-1><a href=#__codelineno-12-1 id=__codelineno-12-1 name=__codelineno-12-1></a><span class=c1># Task 1</span>
</span><span id=__span-12-2><a href=#__codelineno-12-2 id=__codelineno-12-2 name=__codelineno-12-2></a><span class=n>task1</span> <span class=o>=</span> <span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>task_repository</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-12-3><a href=#__codelineno-12-3 id=__codelineno-12-3 name=__codelineno-12-3></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"task1"</span><span class=p>,</span>
</span><span id=__span-12-4><a href=#__codelineno-12-4 id=__codelineno-12-4 name=__codelineno-12-4></a>    <span class=n>user_id</span><span class=o>=</span><span class=s2>"user123"</span><span class=p>,</span>
</span><span id=__span-12-5><a href=#__codelineno-12-5 id=__codelineno-12-5 name=__codelineno-12-5></a>    <span class=n>priority</span><span class=o>=</span><span class=mi>1</span>
</span><span id=__span-12-6><a href=#__codelineno-12-6 id=__codelineno-12-6 name=__codelineno-12-6></a><span class=p>)</span>
</span><span id=__span-12-7><a href=#__codelineno-12-7 id=__codelineno-12-7 name=__codelineno-12-7></a>
</span><span id=__span-12-8><a href=#__codelineno-12-8 id=__codelineno-12-8 name=__codelineno-12-8></a><span class=c1># Task 2</span>
</span><span id=__span-12-9><a href=#__codelineno-12-9 id=__codelineno-12-9 name=__codelineno-12-9></a><span class=n>task2</span> <span class=o>=</span> <span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>task_repository</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-12-10><a href=#__codelineno-12-10 id=__codelineno-12-10 name=__codelineno-12-10></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"task2"</span><span class=p>,</span>
</span><span id=__span-12-11><a href=#__codelineno-12-11 id=__codelineno-12-11 name=__codelineno-12-11></a>    <span class=n>user_id</span><span class=o>=</span><span class=s2>"user123"</span><span class=p>,</span>
</span><span id=__span-12-12><a href=#__codelineno-12-12 id=__codelineno-12-12 name=__codelineno-12-12></a>    <span class=n>priority</span><span class=o>=</span><span class=mi>1</span>
</span><span id=__span-12-13><a href=#__codelineno-12-13 id=__codelineno-12-13 name=__codelineno-12-13></a><span class=p>)</span>
</span><span id=__span-12-14><a href=#__codelineno-12-14 id=__codelineno-12-14 name=__codelineno-12-14></a>
</span><span id=__span-12-15><a href=#__codelineno-12-15 id=__codelineno-12-15 name=__codelineno-12-15></a><span class=c1># Task 3 depends on BOTH Task 1 and Task 2</span>
</span><span id=__span-12-16><a href=#__codelineno-12-16 id=__codelineno-12-16 name=__codelineno-12-16></a><span class=n>task3</span> <span class=o>=</span> <span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>task_repository</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-12-17><a href=#__codelineno-12-17 id=__codelineno-12-17 name=__codelineno-12-17></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"task3"</span><span class=p>,</span>
</span><span id=__span-12-18><a href=#__codelineno-12-18 id=__codelineno-12-18 name=__codelineno-12-18></a>    <span class=n>user_id</span><span class=o>=</span><span class=s2>"user123"</span><span class=p>,</span>
</span><span id=__span-12-19><a href=#__codelineno-12-19 id=__codelineno-12-19 name=__codelineno-12-19></a>    <span class=n>parent_id</span><span class=o>=</span><span class=n>root_task</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
</span><span id=__span-12-20><a href=#__codelineno-12-20 id=__codelineno-12-20 name=__codelineno-12-20></a>    <span class=n>dependencies</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-12-21><a href=#__codelineno-12-21 id=__codelineno-12-21 name=__codelineno-12-21></a>        <span class=p>{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>task1</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>True</span><span class=p>},</span>
</span><span id=__span-12-22><a href=#__codelineno-12-22 id=__codelineno-12-22 name=__codelineno-12-22></a>        <span class=p>{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>task2</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>True</span><span class=p>}</span>
</span><span id=__span-12-23><a href=#__codelineno-12-23 id=__codelineno-12-23 name=__codelineno-12-23></a>    <span class=p>],</span>
</span><span id=__span-12-24><a href=#__codelineno-12-24 id=__codelineno-12-24 name=__codelineno-12-24></a>    <span class=n>priority</span><span class=o>=</span><span class=mi>2</span>
</span><span id=__span-12-25><a href=#__codelineno-12-25 id=__codelineno-12-25 name=__codelineno-12-25></a><span class=p>)</span>
</span></code></pre></div> <p><strong>Execution Flow:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-13-1><a href=#__codelineno-13-1 id=__codelineno-13-1 name=__codelineno-13-1></a>Task 1 ──┐
</span><span id=__span-13-2><a href=#__codelineno-13-2 id=__codelineno-13-2 name=__codelineno-13-2></a>         ├──→ Task 3 (waits for both)
</span><span id=__span-13-3><a href=#__codelineno-13-3 id=__codelineno-13-3 name=__codelineno-13-3></a>Task 2 ──┘
</span></code></pre></div></p> <p>Task 3 will only execute after <strong>both</strong> Task 1 and Task 2 complete.</p> <h3 id=dependency-types>Dependency Types<a class=headerlink href=#dependency-types title="Permanent link">¶</a></h3> <h4 id=required-dependencies>Required Dependencies<a class=headerlink href=#required-dependencies title="Permanent link">¶</a></h4> <p>Required dependencies must complete successfully:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-14-1><a href=#__codelineno-14-1 id=__codelineno-14-1 name=__codelineno-14-1></a><span class=n>dependencies</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-14-2><a href=#__codelineno-14-2 id=__codelineno-14-2 name=__codelineno-14-2></a>    <span class=p>{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>task1</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>True</span><span class=p>}</span>  <span class=c1># Must complete successfully</span>
</span><span id=__span-14-3><a href=#__codelineno-14-3 id=__codelineno-14-3 name=__codelineno-14-3></a><span class=p>]</span>
</span></code></pre></div> <p><strong>Behavior:</strong> - Task waits for dependency to complete - If dependency fails, dependent task does NOT execute - This is the default behavior</p> <h4 id=optional-dependencies>Optional Dependencies<a class=headerlink href=#optional-dependencies title="Permanent link">¶</a></h4> <p>Optional dependencies allow execution even if dependency fails:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-15-1><a href=#__codelineno-15-1 id=__codelineno-15-1 name=__codelineno-15-1></a><span class=n>dependencies</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-15-2><a href=#__codelineno-15-2 id=__codelineno-15-2 name=__codelineno-15-2></a>    <span class=p>{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>task1</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>False</span><span class=p>}</span>  <span class=c1># Can execute even if task1 fails</span>
</span><span id=__span-15-3><a href=#__codelineno-15-3 id=__codelineno-15-3 name=__codelineno-15-3></a><span class=p>]</span>
</span></code></pre></div> <p><strong>Behavior:</strong> - Task waits for dependency to complete (or fail) - If dependency fails, dependent task still executes - Useful for fallback scenarios</p> <p><strong>Example:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-16-1><a href=#__codelineno-16-1 id=__codelineno-16-1 name=__codelineno-16-1></a><span class=c1># Primary task</span>
</span><span id=__span-16-2><a href=#__codelineno-16-2 id=__codelineno-16-2 name=__codelineno-16-2></a><span class=n>primary</span> <span class=o>=</span> <span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>task_repository</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-16-3><a href=#__codelineno-16-3 id=__codelineno-16-3 name=__codelineno-16-3></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"primary_task"</span><span class=p>,</span>
</span><span id=__span-16-4><a href=#__codelineno-16-4 id=__codelineno-16-4 name=__codelineno-16-4></a>    <span class=n>user_id</span><span class=o>=</span><span class=s2>"user123"</span><span class=p>,</span>
</span><span id=__span-16-5><a href=#__codelineno-16-5 id=__codelineno-16-5 name=__codelineno-16-5></a>    <span class=n>priority</span><span class=o>=</span><span class=mi>1</span>
</span><span id=__span-16-6><a href=#__codelineno-16-6 id=__codelineno-16-6 name=__codelineno-16-6></a><span class=p>)</span>
</span><span id=__span-16-7><a href=#__codelineno-16-7 id=__codelineno-16-7 name=__codelineno-16-7></a>
</span><span id=__span-16-8><a href=#__codelineno-16-8 id=__codelineno-16-8 name=__codelineno-16-8></a><span class=c1># Fallback task (runs even if primary fails)</span>
</span><span id=__span-16-9><a href=#__codelineno-16-9 id=__codelineno-16-9 name=__codelineno-16-9></a><span class=n>fallback</span> <span class=o>=</span> <span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>task_repository</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-16-10><a href=#__codelineno-16-10 id=__codelineno-16-10 name=__codelineno-16-10></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"fallback_task"</span><span class=p>,</span>
</span><span id=__span-16-11><a href=#__codelineno-16-11 id=__codelineno-16-11 name=__codelineno-16-11></a>    <span class=n>user_id</span><span class=o>=</span><span class=s2>"user123"</span><span class=p>,</span>
</span><span id=__span-16-12><a href=#__codelineno-16-12 id=__codelineno-16-12 name=__codelineno-16-12></a>    <span class=n>dependencies</span><span class=o>=</span><span class=p>[{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>primary</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>False</span><span class=p>}],</span>  <span class=c1># Optional</span>
</span><span id=__span-16-13><a href=#__codelineno-16-13 id=__codelineno-16-13 name=__codelineno-16-13></a>    <span class=n>priority</span><span class=o>=</span><span class=mi>2</span>
</span><span id=__span-16-14><a href=#__codelineno-16-14 id=__codelineno-16-14 name=__codelineno-16-14></a><span class=p>)</span>
</span></code></pre></div></p> <h2 id=priorities>Priorities<a class=headerlink href=#priorities title="Permanent link">¶</a></h2> <p>Priorities control execution order when multiple tasks are ready to run.</p> <h3 id=priority-levels>Priority Levels<a class=headerlink href=#priority-levels title="Permanent link">¶</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-17-1><a href=#__codelineno-17-1 id=__codelineno-17-1 name=__codelineno-17-1></a>0 = Urgent (highest priority)
</span><span id=__span-17-2><a href=#__codelineno-17-2 id=__codelineno-17-2 name=__codelineno-17-2></a>1 = High
</span><span id=__span-17-3><a href=#__codelineno-17-3 id=__codelineno-17-3 name=__codelineno-17-3></a>2 = Normal (default)
</span><span id=__span-17-4><a href=#__codelineno-17-4 id=__codelineno-17-4 name=__codelineno-17-4></a>3 = Low (lowest priority)
</span></code></pre></div> <p><strong>Rule</strong>: Lower numbers = higher priority = execute first</p> <h3 id=basic-priority>Basic Priority<a class=headerlink href=#basic-priority title="Permanent link">¶</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-18-1><a href=#__codelineno-18-1 id=__codelineno-18-1 name=__codelineno-18-1></a><span class=c1># Urgent task (executes first)</span>
</span><span id=__span-18-2><a href=#__codelineno-18-2 id=__codelineno-18-2 name=__codelineno-18-2></a><span class=n>urgent</span> <span class=o>=</span> <span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>task_repository</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-18-3><a href=#__codelineno-18-3 id=__codelineno-18-3 name=__codelineno-18-3></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"urgent_task"</span><span class=p>,</span>
</span><span id=__span-18-4><a href=#__codelineno-18-4 id=__codelineno-18-4 name=__codelineno-18-4></a>    <span class=n>user_id</span><span class=o>=</span><span class=s2>"user123"</span><span class=p>,</span>
</span><span id=__span-18-5><a href=#__codelineno-18-5 id=__codelineno-18-5 name=__codelineno-18-5></a>    <span class=n>priority</span><span class=o>=</span><span class=mi>0</span>  <span class=c1># Highest priority</span>
</span><span id=__span-18-6><a href=#__codelineno-18-6 id=__codelineno-18-6 name=__codelineno-18-6></a><span class=p>)</span>
</span><span id=__span-18-7><a href=#__codelineno-18-7 id=__codelineno-18-7 name=__codelineno-18-7></a>
</span><span id=__span-18-8><a href=#__codelineno-18-8 id=__codelineno-18-8 name=__codelineno-18-8></a><span class=c1># Normal task (executes after urgent)</span>
</span><span id=__span-18-9><a href=#__codelineno-18-9 id=__codelineno-18-9 name=__codelineno-18-9></a><span class=n>normal</span> <span class=o>=</span> <span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>task_repository</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-18-10><a href=#__codelineno-18-10 id=__codelineno-18-10 name=__codelineno-18-10></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"normal_task"</span><span class=p>,</span>
</span><span id=__span-18-11><a href=#__codelineno-18-11 id=__codelineno-18-11 name=__codelineno-18-11></a>    <span class=n>user_id</span><span class=o>=</span><span class=s2>"user123"</span><span class=p>,</span>
</span><span id=__span-18-12><a href=#__codelineno-18-12 id=__codelineno-18-12 name=__codelineno-18-12></a>    <span class=n>priority</span><span class=o>=</span><span class=mi>2</span>  <span class=c1># Normal priority</span>
</span><span id=__span-18-13><a href=#__codelineno-18-13 id=__codelineno-18-13 name=__codelineno-18-13></a><span class=p>)</span>
</span></code></pre></div> <p><strong>Execution Order:</strong> 1. Urgent task (priority 0) 2. Normal task (priority 2)</p> <h3 id=priority-with-dependencies>Priority with Dependencies<a class=headerlink href=#priority-with-dependencies title="Permanent link">¶</a></h3> <p><strong>Important</strong>: Dependencies take precedence over priorities!</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-19-1><a href=#__codelineno-19-1 id=__codelineno-19-1 name=__codelineno-19-1></a><span class=c1># Task 1 (priority 2, no dependencies)</span>
</span><span id=__span-19-2><a href=#__codelineno-19-2 id=__codelineno-19-2 name=__codelineno-19-2></a><span class=n>task1</span> <span class=o>=</span> <span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>task_repository</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-19-3><a href=#__codelineno-19-3 id=__codelineno-19-3 name=__codelineno-19-3></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"task1"</span><span class=p>,</span>
</span><span id=__span-19-4><a href=#__codelineno-19-4 id=__codelineno-19-4 name=__codelineno-19-4></a>    <span class=n>user_id</span><span class=o>=</span><span class=s2>"user123"</span><span class=p>,</span>
</span><span id=__span-19-5><a href=#__codelineno-19-5 id=__codelineno-19-5 name=__codelineno-19-5></a>    <span class=n>priority</span><span class=o>=</span><span class=mi>2</span>
</span><span id=__span-19-6><a href=#__codelineno-19-6 id=__codelineno-19-6 name=__codelineno-19-6></a><span class=p>)</span>
</span><span id=__span-19-7><a href=#__codelineno-19-7 id=__codelineno-19-7 name=__codelineno-19-7></a>
</span><span id=__span-19-8><a href=#__codelineno-19-8 id=__codelineno-19-8 name=__codelineno-19-8></a><span class=c1># Task 2 (priority 0, depends on Task 1)</span>
</span><span id=__span-19-9><a href=#__codelineno-19-9 id=__codelineno-19-9 name=__codelineno-19-9></a><span class=n>task2</span> <span class=o>=</span> <span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>task_repository</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-19-10><a href=#__codelineno-19-10 id=__codelineno-19-10 name=__codelineno-19-10></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"task2"</span><span class=p>,</span>
</span><span id=__span-19-11><a href=#__codelineno-19-11 id=__codelineno-19-11 name=__codelineno-19-11></a>    <span class=n>user_id</span><span class=o>=</span><span class=s2>"user123"</span><span class=p>,</span>
</span><span id=__span-19-12><a href=#__codelineno-19-12 id=__codelineno-19-12 name=__codelineno-19-12></a>    <span class=n>dependencies</span><span class=o>=</span><span class=p>[{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>task1</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>True</span><span class=p>}],</span>
</span><span id=__span-19-13><a href=#__codelineno-19-13 id=__codelineno-19-13 name=__codelineno-19-13></a>    <span class=n>priority</span><span class=o>=</span><span class=mi>0</span>  <span class=c1># Higher priority, but still waits for Task 1!</span>
</span><span id=__span-19-14><a href=#__codelineno-19-14 id=__codelineno-19-14 name=__codelineno-19-14></a><span class=p>)</span>
</span></code></pre></div> <p><strong>Execution Order:</strong> 1. Task 1 (priority 2, but no dependencies - runs first) 2. Task 2 (priority 0, but waits for Task 1 - runs second)</p> <p><strong>Key Point</strong>: Even though Task 2 has higher priority, it waits for Task 1 because of the dependency!</p> <h3 id=priority-best-practices>Priority Best Practices<a class=headerlink href=#priority-best-practices title="Permanent link">¶</a></h3> <ol> <li><strong>Use consistently</strong>: Establish priority conventions in your project</li> <li><strong>Don't overuse</strong>: Most tasks should use priority 2 (normal)</li> <li><strong>Reserve 0 for emergencies</strong>: Only use priority 0 for critical tasks</li> <li><strong>Remember dependencies</strong>: Priorities only matter when tasks are ready to run</li> </ol> <h2 id=common-patterns>Common Patterns<a class=headerlink href=#common-patterns title="Permanent link">¶</a></h2> <h3 id=pattern-1-sequential-pipeline>Pattern 1: Sequential Pipeline<a class=headerlink href=#pattern-1-sequential-pipeline title="Permanent link">¶</a></h3> <p><strong>Use Case</strong>: Steps that must happen in order</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-20-1><a href=#__codelineno-20-1 id=__codelineno-20-1 name=__codelineno-20-1></a>Task 1 → Task 2 → Task 3
</span></code></pre></div> <p><strong>Implementation:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-21-1><a href=#__codelineno-21-1 id=__codelineno-21-1 name=__codelineno-21-1></a><span class=n>task1</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"step1"</span><span class=p>)</span>
</span><span id=__span-21-2><a href=#__codelineno-21-2 id=__codelineno-21-2 name=__codelineno-21-2></a><span class=n>task2</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-21-3><a href=#__codelineno-21-3 id=__codelineno-21-3 name=__codelineno-21-3></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"step2"</span><span class=p>,</span>
</span><span id=__span-21-4><a href=#__codelineno-21-4 id=__codelineno-21-4 name=__codelineno-21-4></a>    <span class=n>dependencies</span><span class=o>=</span><span class=p>[{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>task1</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>True</span><span class=p>}]</span>
</span><span id=__span-21-5><a href=#__codelineno-21-5 id=__codelineno-21-5 name=__codelineno-21-5></a><span class=p>)</span>
</span><span id=__span-21-6><a href=#__codelineno-21-6 id=__codelineno-21-6 name=__codelineno-21-6></a><span class=n>task3</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-21-7><a href=#__codelineno-21-7 id=__codelineno-21-7 name=__codelineno-21-7></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"step3"</span><span class=p>,</span>
</span><span id=__span-21-8><a href=#__codelineno-21-8 id=__codelineno-21-8 name=__codelineno-21-8></a>    <span class=n>dependencies</span><span class=o>=</span><span class=p>[{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>task2</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>True</span><span class=p>}]</span>
</span><span id=__span-21-9><a href=#__codelineno-21-9 id=__codelineno-21-9 name=__codelineno-21-9></a><span class=p>)</span>
</span></code></pre></div></p> <p><strong>Examples:</strong> - Data pipeline: Fetch → Process → Save - Build process: Compile → Test → Deploy - ETL: Extract → Transform → Load</p> <h3 id=pattern-2-fan-out-parallel>Pattern 2: Fan-Out (Parallel)<a class=headerlink href=#pattern-2-fan-out-parallel title="Permanent link">¶</a></h3> <p><strong>Use Case</strong>: One task spawns multiple independent tasks</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-22-1><a href=#__codelineno-22-1 id=__codelineno-22-1 name=__codelineno-22-1></a>Root Task
</span><span id=__span-22-2><a href=#__codelineno-22-2 id=__codelineno-22-2 name=__codelineno-22-2></a>│
</span><span id=__span-22-3><a href=#__codelineno-22-3 id=__codelineno-22-3 name=__codelineno-22-3></a>├── Task 1 (parallel)
</span><span id=__span-22-4><a href=#__codelineno-22-4 id=__codelineno-22-4 name=__codelineno-22-4></a>├── Task 2 (parallel)
</span><span id=__span-22-5><a href=#__codelineno-22-5 id=__codelineno-22-5 name=__codelineno-22-5></a>└── Task 3 (parallel)
</span></code></pre></div> <p><strong>Implementation:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-23-1><a href=#__codelineno-23-1 id=__codelineno-23-1 name=__codelineno-23-1></a><span class=n>root</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"root"</span><span class=p>)</span>
</span><span id=__span-23-2><a href=#__codelineno-23-2 id=__codelineno-23-2 name=__codelineno-23-2></a><span class=n>task1</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"task1"</span><span class=p>,</span> <span class=n>parent_id</span><span class=o>=</span><span class=n>root</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>  <span class=c1># No dependencies</span>
</span><span id=__span-23-3><a href=#__codelineno-23-3 id=__codelineno-23-3 name=__codelineno-23-3></a><span class=n>task2</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"task2"</span><span class=p>,</span> <span class=n>parent_id</span><span class=o>=</span><span class=n>root</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>  <span class=c1># No dependencies</span>
</span><span id=__span-23-4><a href=#__codelineno-23-4 id=__codelineno-23-4 name=__codelineno-23-4></a><span class=n>task3</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"task3"</span><span class=p>,</span> <span class=n>parent_id</span><span class=o>=</span><span class=n>root</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>  <span class=c1># No dependencies</span>
</span></code></pre></div></p> <p><strong>Examples:</strong> - Process multiple files in parallel - Call multiple APIs simultaneously - Run independent analyses</p> <h3 id=pattern-3-fan-in-converge>Pattern 3: Fan-In (Converge)<a class=headerlink href=#pattern-3-fan-in-converge title="Permanent link">¶</a></h3> <p><strong>Use Case</strong>: Multiple tasks converge to one final task</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-24-1><a href=#__codelineno-24-1 id=__codelineno-24-1 name=__codelineno-24-1></a>Task 1 ──┐
</span><span id=__span-24-2><a href=#__codelineno-24-2 id=__codelineno-24-2 name=__codelineno-24-2></a>Task 2 ──├──→ Final Task
</span><span id=__span-24-3><a href=#__codelineno-24-3 id=__codelineno-24-3 name=__codelineno-24-3></a>Task 3 ──┘
</span></code></pre></div> <p><strong>Implementation:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-25-1><a href=#__codelineno-25-1 id=__codelineno-25-1 name=__codelineno-25-1></a><span class=n>task1</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"task1"</span><span class=p>)</span>
</span><span id=__span-25-2><a href=#__codelineno-25-2 id=__codelineno-25-2 name=__codelineno-25-2></a><span class=n>task2</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"task2"</span><span class=p>)</span>
</span><span id=__span-25-3><a href=#__codelineno-25-3 id=__codelineno-25-3 name=__codelineno-25-3></a><span class=n>task3</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"task3"</span><span class=p>)</span>
</span><span id=__span-25-4><a href=#__codelineno-25-4 id=__codelineno-25-4 name=__codelineno-25-4></a>
</span><span id=__span-25-5><a href=#__codelineno-25-5 id=__codelineno-25-5 name=__codelineno-25-5></a><span class=n>final</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-25-6><a href=#__codelineno-25-6 id=__codelineno-25-6 name=__codelineno-25-6></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"final"</span><span class=p>,</span>
</span><span id=__span-25-7><a href=#__codelineno-25-7 id=__codelineno-25-7 name=__codelineno-25-7></a>    <span class=n>dependencies</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-25-8><a href=#__codelineno-25-8 id=__codelineno-25-8 name=__codelineno-25-8></a>        <span class=p>{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>task1</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>True</span><span class=p>},</span>
</span><span id=__span-25-9><a href=#__codelineno-25-9 id=__codelineno-25-9 name=__codelineno-25-9></a>        <span class=p>{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>task2</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>True</span><span class=p>},</span>
</span><span id=__span-25-10><a href=#__codelineno-25-10 id=__codelineno-25-10 name=__codelineno-25-10></a>        <span class=p>{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>task3</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>True</span><span class=p>}</span>
</span><span id=__span-25-11><a href=#__codelineno-25-11 id=__codelineno-25-11 name=__codelineno-25-11></a>    <span class=p>]</span>
</span><span id=__span-25-12><a href=#__codelineno-25-12 id=__codelineno-25-12 name=__codelineno-25-12></a><span class=p>)</span>
</span></code></pre></div></p> <p><strong>Examples:</strong> - Aggregate results from multiple sources - Combine data from parallel processing - Merge multiple analyses</p> <h3 id=pattern-4-complex-workflow>Pattern 4: Complex Workflow<a class=headerlink href=#pattern-4-complex-workflow title="Permanent link">¶</a></h3> <p><strong>Use Case</strong>: Combination of patterns</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-26-1><a href=#__codelineno-26-1 id=__codelineno-26-1 name=__codelineno-26-1></a>Root
</span><span id=__span-26-2><a href=#__codelineno-26-2 id=__codelineno-26-2 name=__codelineno-26-2></a>│
</span><span id=__span-26-3><a href=#__codelineno-26-3 id=__codelineno-26-3 name=__codelineno-26-3></a>├── Task 1 ──┐
</span><span id=__span-26-4><a href=#__codelineno-26-4 id=__codelineno-26-4 name=__codelineno-26-4></a>│           │
</span><span id=__span-26-5><a href=#__codelineno-26-5 id=__codelineno-26-5 name=__codelineno-26-5></a>├── Task 2 ─┼──→ Task 4 ──┐
</span><span id=__span-26-6><a href=#__codelineno-26-6 id=__codelineno-26-6 name=__codelineno-26-6></a>│           │              │
</span><span id=__span-26-7><a href=#__codelineno-26-7 id=__codelineno-26-7 name=__codelineno-26-7></a>└── Task 3 ─┘              ├──→ Final
</span><span id=__span-26-8><a href=#__codelineno-26-8 id=__codelineno-26-8 name=__codelineno-26-8></a>                            │
</span><span id=__span-26-9><a href=#__codelineno-26-9 id=__codelineno-26-9 name=__codelineno-26-9></a>                            └──→ Task 5
</span></code></pre></div> <p><strong>Implementation:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-27-1><a href=#__codelineno-27-1 id=__codelineno-27-1 name=__codelineno-27-1></a><span class=n>root</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"root"</span><span class=p>)</span>
</span><span id=__span-27-2><a href=#__codelineno-27-2 id=__codelineno-27-2 name=__codelineno-27-2></a><span class=n>task1</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"task1"</span><span class=p>,</span> <span class=n>parent_id</span><span class=o>=</span><span class=n>root</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
</span><span id=__span-27-3><a href=#__codelineno-27-3 id=__codelineno-27-3 name=__codelineno-27-3></a><span class=n>task2</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"task2"</span><span class=p>,</span> <span class=n>parent_id</span><span class=o>=</span><span class=n>root</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
</span><span id=__span-27-4><a href=#__codelineno-27-4 id=__codelineno-27-4 name=__codelineno-27-4></a><span class=n>task3</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"task3"</span><span class=p>,</span> <span class=n>parent_id</span><span class=o>=</span><span class=n>root</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
</span><span id=__span-27-5><a href=#__codelineno-27-5 id=__codelineno-27-5 name=__codelineno-27-5></a>
</span><span id=__span-27-6><a href=#__codelineno-27-6 id=__codelineno-27-6 name=__codelineno-27-6></a><span class=n>task4</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-27-7><a href=#__codelineno-27-7 id=__codelineno-27-7 name=__codelineno-27-7></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"task4"</span><span class=p>,</span>
</span><span id=__span-27-8><a href=#__codelineno-27-8 id=__codelineno-27-8 name=__codelineno-27-8></a>    <span class=n>parent_id</span><span class=o>=</span><span class=n>root</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
</span><span id=__span-27-9><a href=#__codelineno-27-9 id=__codelineno-27-9 name=__codelineno-27-9></a>    <span class=n>dependencies</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-27-10><a href=#__codelineno-27-10 id=__codelineno-27-10 name=__codelineno-27-10></a>        <span class=p>{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>task1</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>True</span><span class=p>},</span>
</span><span id=__span-27-11><a href=#__codelineno-27-11 id=__codelineno-27-11 name=__codelineno-27-11></a>        <span class=p>{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>task2</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>True</span><span class=p>},</span>
</span><span id=__span-27-12><a href=#__codelineno-27-12 id=__codelineno-27-12 name=__codelineno-27-12></a>        <span class=p>{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>task3</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>True</span><span class=p>}</span>
</span><span id=__span-27-13><a href=#__codelineno-27-13 id=__codelineno-27-13 name=__codelineno-27-13></a>    <span class=p>]</span>
</span><span id=__span-27-14><a href=#__codelineno-27-14 id=__codelineno-27-14 name=__codelineno-27-14></a><span class=p>)</span>
</span><span id=__span-27-15><a href=#__codelineno-27-15 id=__codelineno-27-15 name=__codelineno-27-15></a>
</span><span id=__span-27-16><a href=#__codelineno-27-16 id=__codelineno-27-16 name=__codelineno-27-16></a><span class=n>task5</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"task5"</span><span class=p>,</span> <span class=n>parent_id</span><span class=o>=</span><span class=n>root</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
</span><span id=__span-27-17><a href=#__codelineno-27-17 id=__codelineno-27-17 name=__codelineno-27-17></a>
</span><span id=__span-27-18><a href=#__codelineno-27-18 id=__codelineno-27-18 name=__codelineno-27-18></a><span class=n>final</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-27-19><a href=#__codelineno-27-19 id=__codelineno-27-19 name=__codelineno-27-19></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"final"</span><span class=p>,</span>
</span><span id=__span-27-20><a href=#__codelineno-27-20 id=__codelineno-27-20 name=__codelineno-27-20></a>    <span class=n>parent_id</span><span class=o>=</span><span class=n>root</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
</span><span id=__span-27-21><a href=#__codelineno-27-21 id=__codelineno-27-21 name=__codelineno-27-21></a>    <span class=n>dependencies</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-27-22><a href=#__codelineno-27-22 id=__codelineno-27-22 name=__codelineno-27-22></a>        <span class=p>{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>task4</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>True</span><span class=p>},</span>
</span><span id=__span-27-23><a href=#__codelineno-27-23 id=__codelineno-27-23 name=__codelineno-27-23></a>        <span class=p>{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>task5</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>True</span><span class=p>}</span>
</span><span id=__span-27-24><a href=#__codelineno-27-24 id=__codelineno-27-24 name=__codelineno-27-24></a>    <span class=p>]</span>
</span><span id=__span-27-25><a href=#__codelineno-27-25 id=__codelineno-27-25 name=__codelineno-27-25></a><span class=p>)</span>
</span></code></pre></div></p> <h3 id=pattern-5-conditional-execution>Pattern 5: Conditional Execution<a class=headerlink href=#pattern-5-conditional-execution title="Permanent link">¶</a></h3> <p><strong>Use Case</strong>: Fallback or alternative paths</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-28-1><a href=#__codelineno-28-1 id=__codelineno-28-1 name=__codelineno-28-1></a>Primary Task ──┐
</span><span id=__span-28-2><a href=#__codelineno-28-2 id=__codelineno-28-2 name=__codelineno-28-2></a>               ├──→ Success Task
</span><span id=__span-28-3><a href=#__codelineno-28-3 id=__codelineno-28-3 name=__codelineno-28-3></a>               │
</span><span id=__span-28-4><a href=#__codelineno-28-4 id=__codelineno-28-4 name=__codelineno-28-4></a>Fallback Task ─┘
</span></code></pre></div> <p><strong>Implementation:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-29-1><a href=#__codelineno-29-1 id=__codelineno-29-1 name=__codelineno-29-1></a><span class=n>primary</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"primary"</span><span class=p>)</span>
</span><span id=__span-29-2><a href=#__codelineno-29-2 id=__codelineno-29-2 name=__codelineno-29-2></a><span class=n>fallback</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"fallback"</span><span class=p>)</span>
</span><span id=__span-29-3><a href=#__codelineno-29-3 id=__codelineno-29-3 name=__codelineno-29-3></a>
</span><span id=__span-29-4><a href=#__codelineno-29-4 id=__codelineno-29-4 name=__codelineno-29-4></a><span class=n>success</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-29-5><a href=#__codelineno-29-5 id=__codelineno-29-5 name=__codelineno-29-5></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"success"</span><span class=p>,</span>
</span><span id=__span-29-6><a href=#__codelineno-29-6 id=__codelineno-29-6 name=__codelineno-29-6></a>    <span class=n>dependencies</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-29-7><a href=#__codelineno-29-7 id=__codelineno-29-7 name=__codelineno-29-7></a>        <span class=p>{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>primary</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>False</span><span class=p>},</span>  <span class=c1># Optional</span>
</span><span id=__span-29-8><a href=#__codelineno-29-8 id=__codelineno-29-8 name=__codelineno-29-8></a>        <span class=p>{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>fallback</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>False</span><span class=p>}</span>  <span class=c1># Optional</span>
</span><span id=__span-29-9><a href=#__codelineno-29-9 id=__codelineno-29-9 name=__codelineno-29-9></a>    <span class=p>]</span>
</span><span id=__span-29-10><a href=#__codelineno-29-10 id=__codelineno-29-10 name=__codelineno-29-10></a><span class=p>)</span>
</span></code></pre></div></p> <h2 id=best-practices>Best Practices<a class=headerlink href=#best-practices title="Permanent link">¶</a></h2> <h3 id=1-use-meaningful-task-names>1. Use Meaningful Task Names<a class=headerlink href=#1-use-meaningful-task-names title="Permanent link">¶</a></h3> <p><strong>Good:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-30-1><a href=#__codelineno-30-1 id=__codelineno-30-1 name=__codelineno-30-1></a><span class=n>name</span><span class=o>=</span><span class=s2>"fetch_user_data"</span>
</span><span id=__span-30-2><a href=#__codelineno-30-2 id=__codelineno-30-2 name=__codelineno-30-2></a><span class=n>name</span><span class=o>=</span><span class=s2>"process_payment"</span>
</span><span id=__span-30-3><a href=#__codelineno-30-3 id=__codelineno-30-3 name=__codelineno-30-3></a><span class=n>name</span><span class=o>=</span><span class=s2>"send_notification_email"</span>
</span></code></pre></div></p> <p><strong>Bad:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-31-1><a href=#__codelineno-31-1 id=__codelineno-31-1 name=__codelineno-31-1></a><span class=n>name</span><span class=o>=</span><span class=s2>"task1"</span>
</span><span id=__span-31-2><a href=#__codelineno-31-2 id=__codelineno-31-2 name=__codelineno-31-2></a><span class=n>name</span><span class=o>=</span><span class=s2>"do_stuff"</span>
</span><span id=__span-31-3><a href=#__codelineno-31-3 id=__codelineno-31-3 name=__codelineno-31-3></a><span class=n>name</span><span class=o>=</span><span class=s2>"x"</span>
</span></code></pre></div></p> <h3 id=2-set-appropriate-priorities>2. Set Appropriate Priorities<a class=headerlink href=#2-set-appropriate-priorities title="Permanent link">¶</a></h3> <p><strong>Convention:</strong> - <code>0</code>: Critical/emergency tasks only - <code>1</code>: High priority business tasks - <code>2</code>: Normal tasks (default) - <code>3</code>: Low priority/background tasks</p> <p><strong>Example:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-32-1><a href=#__codelineno-32-1 id=__codelineno-32-1 name=__codelineno-32-1></a><span class=c1># Critical payment processing</span>
</span><span id=__span-32-2><a href=#__codelineno-32-2 id=__codelineno-32-2 name=__codelineno-32-2></a><span class=n>payment</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"process_payment"</span><span class=p>,</span> <span class=n>priority</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-32-3><a href=#__codelineno-32-3 id=__codelineno-32-3 name=__codelineno-32-3></a>
</span><span id=__span-32-4><a href=#__codelineno-32-4 id=__codelineno-32-4 name=__codelineno-32-4></a><span class=c1># Normal data processing</span>
</span><span id=__span-32-5><a href=#__codelineno-32-5 id=__codelineno-32-5 name=__codelineno-32-5></a><span class=n>data</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"process_data"</span><span class=p>,</span> <span class=n>priority</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-32-6><a href=#__codelineno-32-6 id=__codelineno-32-6 name=__codelineno-32-6></a>
</span><span id=__span-32-7><a href=#__codelineno-32-7 id=__codelineno-32-7 name=__codelineno-32-7></a><span class=c1># Background cleanup</span>
</span><span id=__span-32-8><a href=#__codelineno-32-8 id=__codelineno-32-8 name=__codelineno-32-8></a><span class=n>cleanup</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"cleanup"</span><span class=p>,</span> <span class=n>priority</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
</span></code></pre></div></p> <h3 id=3-handle-dependencies-explicitly>3. Handle Dependencies Explicitly<a class=headerlink href=#3-handle-dependencies-explicitly title="Permanent link">¶</a></h3> <p><strong>Always specify dependencies explicitly:</strong></p> <p><strong>Good:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-33-1><a href=#__codelineno-33-1 id=__codelineno-33-1 name=__codelineno-33-1></a><span class=n>task2</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-33-2><a href=#__codelineno-33-2 id=__codelineno-33-2 name=__codelineno-33-2></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"task2"</span><span class=p>,</span>
</span><span id=__span-33-3><a href=#__codelineno-33-3 id=__codelineno-33-3 name=__codelineno-33-3></a>    <span class=n>dependencies</span><span class=o>=</span><span class=p>[{</span><span class=s2>"id"</span><span class=p>:</span> <span class=n>task1</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>True</span><span class=p>}]</span>  <span class=c1># Explicit</span>
</span><span id=__span-33-4><a href=#__codelineno-33-4 id=__codelineno-33-4 name=__codelineno-33-4></a><span class=p>)</span>
</span></code></pre></div></p> <p><strong>Bad:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-34-1><a href=#__codelineno-34-1 id=__codelineno-34-1 name=__codelineno-34-1></a><span class=c1># Relying on implicit order - don't do this!</span>
</span><span id=__span-34-2><a href=#__codelineno-34-2 id=__codelineno-34-2 name=__codelineno-34-2></a><span class=n>task1</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=o>...</span><span class=p>)</span>
</span><span id=__span-34-3><a href=#__codelineno-34-3 id=__codelineno-34-3 name=__codelineno-34-3></a><span class=n>task2</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=o>...</span><span class=p>)</span>  <span class=c1># No dependency, but hoping task1 runs first</span>
</span></code></pre></div></p> <h3 id=4-use-parent-child-for-organization-dependencies-for-execution>4. Use Parent-Child for Organization, Dependencies for Execution<a class=headerlink href=#4-use-parent-child-for-organization-dependencies-for-execution title="Permanent link">¶</a></h3> <p><strong>Remember:</strong> - <code>parent_id</code>: Organization (like folders) - <code>dependencies</code>: Execution order (when tasks run)</p> <p><strong>Good:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-35-1><a href=#__codelineno-35-1 id=__codelineno-35-1 name=__codelineno-35-1></a><span class=n>root</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"root"</span><span class=p>)</span>
</span><span id=__span-35-2><a href=#__codelineno-35-2 id=__codelineno-35-2 name=__codelineno-35-2></a><span class=n>child</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-35-3><a href=#__codelineno-35-3 id=__codelineno-35-3 name=__codelineno-35-3></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"child"</span><span class=p>,</span>
</span><span id=__span-35-4><a href=#__codelineno-35-4 id=__codelineno-35-4 name=__codelineno-35-4></a>    <span class=n>parent_id</span><span class=o>=</span><span class=n>root</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>  <span class=c1># Organizational</span>
</span><span id=__span-35-5><a href=#__codelineno-35-5 id=__codelineno-35-5 name=__codelineno-35-5></a>    <span class=n>dependencies</span><span class=o>=</span><span class=p>[{</span><span class=s2>"id"</span><span class=p>:</span> <span class=s2>"other_task"</span><span class=p>,</span> <span class=s2>"required"</span><span class=p>:</span> <span class=kc>True</span><span class=p>}]</span>  <span class=c1># Execution</span>
</span><span id=__span-35-6><a href=#__codelineno-35-6 id=__codelineno-35-6 name=__codelineno-35-6></a><span class=p>)</span>
</span></code></pre></div></p> <p><strong>Bad:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-36-1><a href=#__codelineno-36-1 id=__codelineno-36-1 name=__codelineno-36-1></a><span class=c1># Don't rely on parent-child for execution order!</span>
</span><span id=__span-36-2><a href=#__codelineno-36-2 id=__codelineno-36-2 name=__codelineno-36-2></a><span class=n>child</span> <span class=o>=</span> <span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-36-3><a href=#__codelineno-36-3 id=__codelineno-36-3 name=__codelineno-36-3></a>    <span class=n>name</span><span class=o>=</span><span class=s2>"child"</span><span class=p>,</span>
</span><span id=__span-36-4><a href=#__codelineno-36-4 id=__codelineno-36-4 name=__codelineno-36-4></a>    <span class=n>parent_id</span><span class=o>=</span><span class=n>root</span><span class=o>.</span><span class=n>id</span>  <span class=c1># This doesn't guarantee execution order!</span>
</span><span id=__span-36-5><a href=#__codelineno-36-5 id=__codelineno-36-5 name=__codelineno-36-5></a><span class=p>)</span>
</span></code></pre></div></p> <h3 id=5-handle-errors-gracefully>5. Handle Errors Gracefully<a class=headerlink href=#5-handle-errors-gracefully title="Permanent link">¶</a></h3> <p><strong>Always check task status:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-37-1><a href=#__codelineno-37-1 id=__codelineno-37-1 name=__codelineno-37-1></a><span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>distribute_task_tree</span><span class=p>(</span><span class=n>task_tree</span><span class=p>)</span>
</span><span id=__span-37-2><a href=#__codelineno-37-2 id=__codelineno-37-2 name=__codelineno-37-2></a>
</span><span id=__span-37-3><a href=#__codelineno-37-3 id=__codelineno-37-3 name=__codelineno-37-3></a><span class=c1># Check all tasks</span>
</span><span id=__span-37-4><a href=#__codelineno-37-4 id=__codelineno-37-4 name=__codelineno-37-4></a><span class=k>for</span> <span class=n>task</span> <span class=ow>in</span> <span class=n>tasks</span><span class=p>:</span>
</span><span id=__span-37-5><a href=#__codelineno-37-5 id=__codelineno-37-5 name=__codelineno-37-5></a>    <span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>task_repository</span><span class=o>.</span><span class=n>get_task_by_id</span><span class=p>(</span><span class=n>task</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
</span><span id=__span-37-6><a href=#__codelineno-37-6 id=__codelineno-37-6 name=__codelineno-37-6></a>    <span class=k>if</span> <span class=n>result</span><span class=o>.</span><span class=n>status</span> <span class=o>==</span> <span class=s2>"failed"</span><span class=p>:</span>
</span><span id=__span-37-7><a href=#__codelineno-37-7 id=__codelineno-37-7 name=__codelineno-37-7></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Task </span><span class=si>{</span><span class=n>task</span><span class=o>.</span><span class=n>id</span><span class=si>}</span><span class=s2> failed: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>error</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-37-8><a href=#__codelineno-37-8 id=__codelineno-37-8 name=__codelineno-37-8></a>        <span class=c1># Handle failure appropriately</span>
</span></code></pre></div> <h3 id=6-keep-task-trees-manageable>6. Keep Task Trees Manageable<a class=headerlink href=#6-keep-task-trees-manageable title="Permanent link">¶</a></h3> <p><strong>Good:</strong> - Break complex workflows into smaller trees - Use clear naming conventions - Document complex dependencies</p> <p><strong>Bad:</strong> - Creating massive trees with hundreds of tasks - Unclear dependency chains - No documentation</p> <h3 id=task-cancellation>Task Cancellation<a class=headerlink href=#task-cancellation title="Permanent link">¶</a></h3> <p>Cancel a running task:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-38-1><a href=#__codelineno-38-1 id=__codelineno-38-1 name=__codelineno-38-1></a><span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>cancel_task</span><span class=p>(</span>
</span><span id=__span-38-2><a href=#__codelineno-38-2 id=__codelineno-38-2 name=__codelineno-38-2></a>    <span class=n>task_id</span><span class=o>=</span><span class=s2>"task_123"</span><span class=p>,</span>
</span><span id=__span-38-3><a href=#__codelineno-38-3 id=__codelineno-38-3 name=__codelineno-38-3></a>    <span class=n>error_message</span><span class=o>=</span><span class=s2>"User requested cancellation"</span>
</span><span id=__span-38-4><a href=#__codelineno-38-4 id=__codelineno-38-4 name=__codelineno-38-4></a><span class=p>)</span>
</span></code></pre></div> <p><strong>Note</strong>: Not all executors support cancellation. Check <code>executor.cancelable</code> property.</p> <h3 id=task-re-execution>Task Re-execution<a class=headerlink href=#task-re-execution title="Permanent link">¶</a></h3> <p>Tasks can be marked for re-execution if dependencies fail:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-39-1><a href=#__codelineno-39-1 id=__codelineno-39-1 name=__codelineno-39-1></a><span class=c1># If a dependency fails, dependent tasks are marked for re-execution</span>
</span><span id=__span-39-2><a href=#__codelineno-39-2 id=__codelineno-39-2 name=__codelineno-39-2></a><span class=c1># This allows retrying failed workflows</span>
</span></code></pre></div> <h3 id=streaming-execution>Streaming Execution<a class=headerlink href=#streaming-execution title="Permanent link">¶</a></h3> <p>Get real-time updates during execution:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-40-1><a href=#__codelineno-40-1 id=__codelineno-40-1 name=__codelineno-40-1></a><span class=c1># Execute with streaming</span>
</span><span id=__span-40-2><a href=#__codelineno-40-2 id=__codelineno-40-2 name=__codelineno-40-2></a><span class=k>await</span> <span class=n>task_manager</span><span class=o>.</span><span class=n>distribute_task_tree_with_streaming</span><span class=p>(</span>
</span><span id=__span-40-3><a href=#__codelineno-40-3 id=__codelineno-40-3 name=__codelineno-40-3></a>    <span class=n>task_tree</span><span class=p>,</span>
</span><span id=__span-40-4><a href=#__codelineno-40-4 id=__codelineno-40-4 name=__codelineno-40-4></a>    <span class=n>use_callback</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-40-5><a href=#__codelineno-40-5 id=__codelineno-40-5 name=__codelineno-40-5></a><span class=p>)</span>
</span></code></pre></div> <h3 id=dependency-resolution>Dependency Resolution<a class=headerlink href=#dependency-resolution title="Permanent link">¶</a></h3> <p>Dependency results are automatically merged into task inputs:</p> <p>```python</p> <h4 id=copy-link-and-snapshot-behavior>Copy, Link, and Snapshot Behavior<a class=headerlink href=#copy-link-and-snapshot-behavior title="Permanent link">¶</a></h4> <p><strong>from_copy:</strong> - Deep copy of a task or tree (optionally with children and dependencies) - All copied tasks get new IDs and are independent from the original - Useful for retries, A/B testing, and templating</p> <p><strong>from_link:</strong> - Creates a reference to an existing task (no data duplication) - Linked tasks share results with the original - Useful for deduplication and sharing computation <strong>Note:</strong> If <code>user_id</code> is specified, the linked task's <code>user_id</code> must match. Linking to a task with a different <code>user_id</code> is not allowed for security and data isolation reasons.</p> <p><strong>from_archive:</strong> - Creates a frozen, read-only copy of a task or tree - Preserves the state at the time of archive - Useful for audit, compliance, and reproducibility</p> <p><strong>from_mixed:</strong> - Advanced: mix links and copies in a new tree - Enables hybrid workflows (e.g., copy some tasks, link others) <strong>Note:</strong> When using links in a mixed tree, if <code>user_id</code> is specified, all linked tasks must have the same <code>user_id</code>. Linking to tasks with a different <code>user_id</code> is not permitted.</p> <p><strong>What Gets Copied or Linked:</strong> - Task definition (name, schemas, inputs, params, etc.) - Task hierarchy (parent-child relationships) - Dependencies (when copying recursively) - Task metadata (user_id, priority, etc.)</p> <p><strong>What Gets Reset (for copies):</strong> - <code>status</code>: Set to <code>"pending"</code> - <code>result</code>: Set to <code>None</code> - <code>progress</code>: Set to <code>0.0</code> - Execution timestamps</p> <p><strong>What Gets Preserved:</strong> - Original task remains unchanged - Execution history and results are preserved in the original</p> <p><strong>Deduplication:</strong> - When copying with children, dependencies are only copied once - The copied tree maintains the same structure as the original <strong>Problem</strong>: Task never completes</p> <p><strong>Solutions</strong>: 1. Check if executor is hanging 2. Verify executor supports cancellation 3. Check for deadlocks in dependencies 4. Review executor implementation</p> <h2 id=next-steps>Next Steps<a class=headerlink href=#next-steps title="Permanent link">¶</a></h2> <ul> <li><strong><a href=../custom-tasks/ >Custom Tasks Guide</a></strong> - Create your own executors</li> <li><strong><a href=../../examples/basic_task/ >Basic Examples</a></strong> - More practical examples</li> <li><strong><a href=../best-practices/ >Best Practices Guide</a></strong> - Advanced techniques</li> <li><strong><a href=../../api/python/ >API Reference</a></strong> - Complete API documentation</li> </ul> <hr> <p><strong>Need help?</strong> Check the <a href=../faq/ >FAQ</a> or <a href=../../getting-started/quick-start/ >Quick Start Guide</a></p> <h2 id=task-data-fields-inputs-params-and-result>Task Data Fields: inputs, params, and result<a class=headerlink href=#task-data-fields-inputs-params-and-result title="Permanent link">¶</a></h2> <p>To ensure clean, composable, and predictable task orchestration, apflow enforces a strict separation of concerns for task data fields:</p> <ul> <li><strong>inputs</strong>: Only business input data for the task. This is the data the executor will process (e.g., text to summarize, file to process, etc.). It should never include configuration, credentials, or executor-specific settings.</li> <li><strong>params</strong>: Only executor configuration and setup parameters (e.g., API keys, model names, connection info). These are used to initialize the executor and are not passed as business data.</li> <li><strong>result</strong>: Only the pure business output of the task. This is the value that downstream tasks will consume as their <code>inputs</code>. The <code>result</code> should not include logs, token usage, internal metadata, or any executor-specific structure—just the output relevant to the user or next task.</li> </ul> <p><strong>Why this matters:</strong> This separation ensures that: - Task data flows are clean and composable in a task tree. - Executors are reusable and predictable. - Downstream tasks can directly use upstream results as their inputs, without worrying about mixed-in configuration or irrelevant metadata.</p> <p><strong>Best Practice:</strong> - Executors should only use <code>params</code> for initialization, process <code>inputs</code> as business data, and return a clean <code>result</code>. - Never mix configuration into <code>inputs</code> or <code>result</code>.</p> <p>For detailed field definitions and examples, see the <a href=https://flow-docs.aipartnerup.com/protocol/03-data-model/ >Data Model Protocol documentation</a>.</p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button class="md-top md-icon" data-md-component=top hidden type=button> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright © 2025 aipartnerup </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material for MkDocs </a> </div> <div class=md-social> <a class=md-social__link href=https://github.com/aipartnerup/apflow rel=noopener target=_blank title=github.com> <svg viewbox="0 0 512 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </a> <a class=md-social__link href=https://pypi.org/project/apflow/ rel=noopener target=_blank title=pypi.org> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8"></path></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.annotate", "content.code.copy", "content.code.select"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> </body> </html>